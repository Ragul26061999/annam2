"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9637],{9637:(e,r,o)=>{o.d(r,{Nf:()=>u,PV:()=>g,Qg:()=>t,ar:()=>i,gd:()=>l,kt:()=>d,oR:()=>s});var a=o(2099);async function t(e){try{var r;let{data:o,error:t}=await a.ND.auth.signUp({email:e.email,password:"password",options:{emailRedirectTo:"".concat(window.location.origin,"/auth/callback"),data:{role:"doctor",name:e.name,email_confirm:!0}}});if(t)throw console.error("Error creating doctor auth user:",t),Error("Failed to create doctor authentication: ".concat(t.message));let i={auth_id:null==(r=o.user)?void 0:r.id,employee_id:e.doctorId,name:e.name,email:e.email,phone:e.phone,address:e.address,role:"doctor",status:"active",permissions:{view_patients:!0,create_appointments:!0,update_medical_records:!0,prescribe_medications:!0}},{data:s,error:n}=await a.ND.from("users").insert([i]).select().single();if(n)throw console.error("Error creating user record:",n),Error("Failed to create user record: ".concat(n.message));e.sessions,e.availableSessions,e.workingDays;let c={user_id:s.id,license_number:e.licenseNumber,specialization:e.specialization,qualification:e.qualification,years_of_experience:e.experienceYears,consultation_fee:e.consultationFee,room_number:e.roomNumber,availability_hours:{sessions:e.sessions,availableSessions:e.availableSessions,workingDays:e.workingDays,emergencyAvailable:e.emergencyAvailable,floorNumber:e.floorNumber,workingHoursStart:e.workingHoursStart,workingHoursEnd:e.workingHoursEnd,department:e.department},status:"active"},{data:l,error:d}=await a.ND.from("doctors").insert([c]).select("\n        *,\n        user:users(id, name, email, phone, address)\n      ").single();if(d)throw console.error("Error creating doctor record:",d),Error("Failed to create doctor record: ".concat(d.message));return l}catch(e){throw console.error("Error creating doctor:",e),e}}async function i(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{page:r=1,limit:o=20,specialization:t,department:i,availabilityStatus:s,searchTerm:c,includeMD:l=!1}=e,d=(r-1)*o,g=a.ND.from("doctors").select("\n        *,\n        user:users(id, name, email, phone, address)\n      ",{count:"exact"});if(t&&(g=g.eq("specialization",t)),i){let e={Cardiology:"Cardiology",Pediatrics:"Pediatrics",Orthopedics:"Orthopedics",Neurology:"Neurology",Dermatology:"Dermatology","Obstetrics & Gynecology":"Gynecology",Psychiatry:"Psychiatry",Radiology:"Radiology",Anesthesiology:"Anesthesiology",Emergency:"Emergency Medicine","Internal Medicine":"Internal Medicine",Surgery:"Surgery"}[i]||null;e&&(g=g.eq("specialization",e))}s&&(g=g.eq("status","active")),c&&(g=g.or("\n        license_number.ilike.%".concat(c,"%,\n        specialization.ilike.%").concat(c,"%\n      ")));let{data:u,error:y,count:h}=await g.range(d,d+o-1).order("created_at",{ascending:!1}),m=u||[];if(y)throw console.error("Error fetching doctors:",y),Error("Failed to fetch doctors: ".concat(y.message));return{doctors:(null==m?void 0:m.map(e=>({...e,doctor_id:e.license_number,department:n(e.specialization),experience_years:e.years_of_experience,working_hours_start:"09:00",working_hours_end:"17:00",working_days:[1,2,3,4,5,6],floor_number:1,availability_status:"available",emergency_available:!1})))||[],total:h||0,page:r,limit:o}}catch(e){throw console.error("Error fetching doctors:",e),e}}async function s(){try{let{data:e,error:r}=await a.ND.from("doctors").select("\n        *,\n        user:users(\n          id,\n          name,\n          email,\n          phone,\n          address\n        )\n      ").eq("status","active").order("created_at",{ascending:!1});if(r)throw console.error("Error fetching doctors:",r),Error("Failed to fetch doctors: ".concat(r.message));let o=e||[];return(null==o?void 0:o.map(e=>({...e,doctor_id:e.license_number,department:n(e.specialization),experience_years:e.years_of_experience,working_hours_start:"09:00",working_hours_end:"17:00",working_days:[1,2,3,4,5,6],floor_number:1,availability_status:"available",emergency_available:!1})))||[]}catch(e){throw console.error("Error fetching doctors:",e),e}}function n(e){return({Cardiology:"Cardiology",Pediatrics:"Pediatrics",Orthopedics:"Orthopedics",Neurology:"Neurology",Dermatology:"Dermatology",Gynecology:"Obstetrics & Gynecology",Psychiatry:"Psychiatry",Radiology:"Radiology",Anesthesiology:"Anesthesiology","Emergency Medicine":"Emergency","Internal Medicine":"Internal Medicine",Surgery:"Surgery",Oncology:"Oncology",Ophthalmology:"Ophthalmology",ENT:"ENT (Ear, Nose & Throat)",Urology:"Urology",Gastroenterology:"Gastroenterology",Endocrinology:"Endocrinology",Nephrology:"Nephrology",Pulmonology:"Pulmonology",Rheumatology:"Rheumatology",Hematology:"Hematology","Infectious Disease":"Infectious Disease",Pathology:"Pathology","Physical Medicine":"Physical Medicine & Rehabilitation","Plastic Surgery":"Plastic Surgery","Vascular Surgery":"Vascular Surgery","Thoracic Surgery":"Thoracic Surgery",Neurosurgery:"Neurosurgery",Dental:"Dental",Physiotherapy:"Physiotherapy",Nutrition:"Nutrition & Dietetics",Other:"Other"})[e]||e}async function c(e){try{let{data:r,error:o}=await supabase.from("doctors").select("\n        *,\n        user:users(id, name, email, phone, address)\n      ").eq("license_number",e).single();if(o)throw console.error("Error fetching doctor:",o),Error("Doctor not found: ".concat(o.message));return{...r,doctor_id:r.license_number,department:n(r.specialization),experience_years:r.years_of_experience,working_hours_start:"09:00",working_hours_end:"17:00",working_days:[1,2,3,4,5,6],floor_number:1,availability_status:"available",emergency_available:!1}}catch(e){throw console.error("Error fetching doctor:",e),e}}async function l(e,r){try{let{data:o,error:t}=await a.ND.from("doctors").update({status:"available"===r?"active":"inactive"}).eq("id",e).select("\n        *,\n        user:users(id, name, email, phone, address)\n      ").single();if(t)throw console.error("Error updating doctor availability:",t),Error("Failed to update doctor availability: ".concat(t.message));return{...o,doctor_id:o.license_number,department:n(o.specialization),experience_years:o.years_of_experience,working_hours_start:"09:00",working_hours_end:"17:00",working_days:[1,2,3,4,5,6],floor_number:1,availability_status:r,emergency_available:!1}}catch(e){throw console.error("Error updating doctor availability:",e),e}}async function d(){try{let{data:e,error:r}=await a.ND.from("doctors").select("specialization").eq("status","active");if(r)throw console.error("Error fetching specializations:",r),Error("Failed to fetch specializations: ".concat(r.message));return[...new Set((null==e?void 0:e.map(e=>e.specialization))||[])].sort()}catch(e){throw console.error("Error fetching specializations:",e),e}}async function g(){try{let{data:e,error:r}=await a.ND.from("doctors").select("specialization").eq("status","active");if(r)throw console.error("Error fetching doctors:",r),Error("Failed to fetch departments: ".concat(r.message));let o={Cardiology:"Cardiology",Pediatrics:"Pediatrics",Orthopedics:"Orthopedics",Neurology:"Neurology",Dermatology:"Dermatology",Gynecology:"Obstetrics & Gynecology",Psychiatry:"Psychiatry",Radiology:"Radiology",Anesthesiology:"Anesthesiology","Emergency Medicine":"Emergency","Internal Medicine":"Internal Medicine",Surgery:"Surgery",Oncology:"Oncology",Ophthalmology:"Ophthalmology",ENT:"ENT (Ear, Nose & Throat)",Urology:"Urology",Gastroenterology:"Gastroenterology",Endocrinology:"Endocrinology",Nephrology:"Nephrology",Pulmonology:"Pulmonology",Rheumatology:"Rheumatology",Hematology:"Hematology","Infectious Disease":"Infectious Disease",Pathology:"Pathology","Physical Medicine":"Physical Medicine & Rehabilitation","Plastic Surgery":"Plastic Surgery","Vascular Surgery":"Vascular Surgery","Thoracic Surgery":"Thoracic Surgery",Neurosurgery:"Neurosurgery",Dental:"Dental",Physiotherapy:"Physiotherapy",Nutrition:"Nutrition & Dietetics",Other:"Other"},t=(null==e?void 0:e.map(e=>o[e.specialization]||e.specialization))||[];return[...new Set(t)].sort()}catch(e){throw console.error("Error fetching departments:",e),e}}async function u(e,r){try{let{data:o,error:t}=await a.ND.from("doctors").select("user_id").eq("id",e).single();if(t)throw console.error("Error fetching doctor:",t),Error("Failed to fetch doctor: ".concat(t.message));let i={...r.name&&{name:r.name},...r.email&&{email:r.email},...r.phone&&{phone:r.phone},...r.address&&{address:r.address}},s={...r.licenseNumber&&{license_number:r.licenseNumber},...r.specialization&&{specialization:r.specialization},...r.qualification&&{qualification:r.qualification},...r.experienceYears&&{years_of_experience:r.experienceYears},...r.consultationFee&&{consultation_fee:r.consultationFee},...r.roomNumber&&{room_number:r.roomNumber},...(r.sessions||r.availableSessions||r.workingDays||void 0!==r.emergencyAvailable)&&{availability_hours:{sessions:r.sessions,availableSessions:r.availableSessions,workingDays:r.workingDays,emergencyAvailable:r.emergencyAvailable,...r.floorNumber&&{floorNumber:r.floorNumber},...r.workingHoursStart&&{workingHoursStart:r.workingHoursStart},...r.workingHoursEnd&&{workingHoursEnd:r.workingHoursEnd}}}};if(Object.keys(i).length>0){let{error:e}=await a.ND.from("users").update(i).eq("id",o.user_id);if(e)throw console.error("Error updating user:",e),Error("Failed to update user: ".concat(e.message))}if(Object.keys(s).length>0){let{error:r}=await a.ND.from("doctors").update(s).eq("id",e);if(r)throw console.error("Error updating doctor:",r),Error("Failed to update doctor: ".concat(r.message))}let{data:n,error:c}=await a.ND.from("doctors").select("*").eq("id",e).single();if(c)throw console.error("Error fetching updated doctor:",c),Error("Failed to fetch updated doctor: ".concat(c.message));let{data:l,error:d}=await a.ND.from("users").select("id, name, email, phone, address").eq("id",n.user_id).single();return d&&console.error("Error fetching user data:",d),{...n,user:l||void 0}}catch(e){throw console.error("Error updating doctor:",e),e}}}}]);