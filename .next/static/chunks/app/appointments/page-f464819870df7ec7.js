(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4921],{861:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>R});var a=s(5155),l=s(2115),r=s(4616),n=s(3109),i=s(9074),d=s(646),o=s(4186),c=s(4861),m=s(7924),x=s(5339),h=s(1154),u=s(5448),g=s(1007),p=s(4020),b=s(3917),j=s(7434),f=s(4416),y=s(1243),N=s(4516),v=s(7475),w=s(2318),A=s(9420),k=s(8883),C=s(2355),S=s(3052),D=s(5549),_=s(8393),M=s(9637),z=s(1172);let P=e=>{let{selectedDate:t,onDateSelect:s,minDate:r,maxDate:n,disabledDates:d=[],className:o=""}=e,[c,m]=(0,l.useState)(new Date),[x,h]=(0,l.useState)("current"),u=new Date,g=new Date(u.getFullYear(),u.getMonth()+1,1);(0,l.useEffect)(()=>{"current"===x?m(u):m(g)},[x]);let p=e=>new Date(e.getFullYear(),e.getMonth()+1,0).getDate(),b=e=>new Date(e.getFullYear(),e.getMonth(),1).getDay(),j=(e,t,s)=>"".concat(e,"-").concat(String(t+1).padStart(2,"0"),"-").concat(String(s).padStart(2,"0")),f=e=>{let t=new Date(e),s=new Date;return s.setHours(0,0,0,0),!!(t<s||r&&e<r||n&&e>n||d.includes(e))};return(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-gray-200 p-6 ".concat(o),children:[(0,a.jsx)("div",{className:"flex items-center justify-center mb-6",children:(0,a.jsxs)("div",{className:"bg-gray-100 rounded-xl p-1 flex",children:[(0,a.jsx)("button",{onClick:()=>h("current"),className:"px-4 py-2 rounded-lg font-semibold text-sm transition-all duration-200 ".concat("current"===x?"bg-white text-blue-600 shadow-md":"text-gray-600 hover:text-blue-600"),children:"This Month"}),(0,a.jsx)("button",{onClick:()=>h("next"),className:"px-4 py-2 rounded-lg font-semibold text-sm transition-all duration-200 ".concat("next"===x?"bg-white text-blue-600 shadow-md":"text-gray-600 hover:text-blue-600"),children:"Next Month"})]})}),(0,a.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-purple-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"w-5 h-5 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-xl font-bold text-gray-900",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][c.getMonth()]," ",c.getFullYear()]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"current"===x?"Current Month":"Next Month"})]})]})}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(e=>(0,a.jsx)("div",{className:"h-8 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-sm font-semibold text-gray-600",children:e})},e))}),(0,a.jsx)("div",{className:"grid grid-cols-7 gap-2",children:(e=>{let l=e.getFullYear(),r=e.getMonth(),n=p(e),i=b(e),d=[];for(let e=0;e<i;e++)d.push((0,a.jsx)("div",{className:"h-12 w-12"},"empty-".concat(e)));for(let e=1;e<=n;e++){let n=j(l,r,e),i=t===n,o=f(n),c=n===j(u.getFullYear(),u.getMonth(),u.getDate());d.push((0,a.jsx)("button",{onClick:()=>!o&&s(n),disabled:o,className:"\n            h-12 w-12 rounded-xl font-semibold text-sm transition-all duration-200\n            ".concat(i?"bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg ring-4 ring-blue-200":o?"bg-gray-100 text-gray-400 cursor-not-allowed":c?"bg-orange-100 text-orange-600 border-2 border-orange-300 hover:bg-orange-200":"bg-white text-gray-700 border-2 border-gray-200 hover:border-blue-300 hover:bg-blue-50 shadow-sm hover:shadow-md","\n          "),children:e},e))}return d})(c)}),(0,a.jsxs)("div",{className:"mt-6 flex flex-wrap items-center justify-center gap-4 text-xs",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-orange-100 border-2 border-orange-300 rounded"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Today"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-gradient-to-r from-blue-500 to-purple-600 rounded"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Selected"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-3 h-3 bg-gray-100 rounded"}),(0,a.jsx)("span",{className:"text-gray-600",children:"Unavailable"})]})]})]})};var T=s(2099);let E=[{id:1,title:"Select Doctor",icon:b.A},{id:2,title:"Choose Date & Time",icon:i.A},{id:3,title:"Select Patient",icon:g.A},{id:4,title:"Appointment Details",icon:j.A},{id:5,title:"Confirmation",icon:d.A}],F=["General Medicine","Cardiology","Neurology","Orthopedics","Pediatrics","Gynecology","Dermatology","Psychiatry","Emergency Medicine","Surgery"],I=[{value:"consultation",label:"General Consultation",duration:30},{value:"follow_up",label:"Follow-up Visit",duration:20},{value:"routine_checkup",label:"Routine Checkup",duration:45},{value:"emergency",label:"Emergency Consultation",duration:60}],L=e=>{var t,s,r,n,c,h;let{isOpen:u,onClose:p,onSuccess:L,preSelectedPatientId:R,preSelectedDoctorId:O}=e,[Y,q]=(0,l.useState)(1),[B,U]=(0,l.useState)(!1),[H,G]=(0,l.useState)(""),[J,V]=(0,l.useState)(""),[W,Z]=(0,l.useState)({patientId:R||"",doctorId:O||"",appointmentDate:"",appointmentTime:"",sessionType:void 0,durationMinutes:30,type:"consultation",symptoms:"",chiefComplaint:"",notes:"",isEmergency:!1}),[X,K]=(0,l.useState)([]),[Q,$]=(0,l.useState)([]),[ee,et]=(0,l.useState)({morning:[],afternoon:[],evening:[]}),[es,ea]=(0,l.useState)([]),[el,er]=(0,l.useState)(null),[en,ei]=(0,l.useState)(null),[ed,eo]=(0,l.useState)(""),[ec,em]=(0,l.useState)(""),[ex,eh]=(0,l.useState)(""),[eu,eg]=(0,l.useState)(""),[ep,eb]=(0,l.useState)(!1),[ej,ef]=(0,l.useState)(!1),[ey,eN]=(0,l.useState)(!1);(0,l.useEffect)(()=>{u&&(ev(),O&&q(2),R&&q(O?4:3))},[u,O,R]);let ev=async()=>{try{U(!0);let[e,t]=await Promise.all([(0,M.oR)(),(0,_.uE)({limit:100})]);K(e||[]);let s=(t.patients||[]).map(e=>({id:e.id,patient_id:e.patient_id,name:e.name||"",phone:e.phone,email:e.email,date_of_birth:e.date_of_birth,gender:e.gender,status:e.status})),a=s.filter((e,t,s)=>t===s.findIndex(t=>t.id===e.id));if($(a),O&&e){let t=e.find(e=>e.id===O);t&&(er(t),Z(e=>({...e,doctorId:t.id})))}if(R){let e=s.find(e=>e.id===R);e&&(ei(e),Z(t=>({...t,patientId:e.id})))}}catch(e){console.error("Error loading data:",e),G("Failed to load data. Please try again.")}finally{U(!1)}},ew=async(e,t)=>{try{U(!0);let s=await (0,D.pN)(e,t,W.isEmergency),a={morning:[],afternoon:[],evening:[]};s.forEach(e=>{if(e.available){let t=parseInt(e.time.split(":")[0]);t<12?a.morning.push(e.time):t<17?a.afternoon.push(e.time):a.evening.push(e.time)}}),et(a)}catch(e){console.error("Error loading slots:",e),G("Failed to load available time slots.")}finally{U(!1)}},eA=e=>{er(e),Z(t=>({...t,doctorId:e.id})),G(""),ek(e.id)},ek=async e=>{let t=eM(),s=ez(),{data:a,error:l}=await T.ND.from("appointments").select("appointment_date").eq("doctor_id",e).gte("appointment_date",t).lte("appointment_date",s).in("status",["scheduled","confirmed","in_progress"]);if(l)return;let r=a.reduce((e,t)=>(e[t.appointment_date]=(e[t.appointment_date]||0)+1,e),{}),n=(null==el?void 0:el.max_patients_per_day)||20;ea(Object.keys(r).filter(e=>r[e]>=n))},eC=e=>{ei(e),Z(t=>({...t,patientId:e.id})),G("")},eS=e=>{let t=ee[e];t.length>0&&Z(s=>({...s,sessionType:e,appointmentTime:t[0]}))},eD=async()=>{try{U(!0),G("");let e=await (0,D.gG)(W),t=(0,D.ic)(null==e?void 0:e.notes);V(t?"Appointment booked successfully! Your token number is ".concat(t,"."):"Appointment booked successfully!"),setTimeout(()=>{null==L||L(e),e_()},2e3)}catch(e){console.error("Error creating appointment:",e),G(e.message||"Failed to book appointment. Please try again.")}finally{U(!1)}},e_=()=>{q(1),Z({patientId:"",doctorId:"",appointmentDate:"",appointmentTime:"",durationMinutes:30,type:"consultation",symptoms:"",chiefComplaint:"",notes:"",isEmergency:!1}),er(null),ei(null),eo(""),em(""),eh(""),eg(""),et({morning:[],afternoon:[],evening:[]}),G(""),V(""),eb(!1),p()},eM=()=>new Date().toISOString().split("T")[0],ez=()=>{let e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString().split("T")[0]},eP=X.filter(e=>{var t,s;let a=!ed||e.specialization===ed,l=!ec||(null==(s=e.user)||null==(t=s.name)?void 0:t.toLowerCase().includes(ec.toLowerCase()))||e.specialization.toLowerCase().includes(ec.toLowerCase());return a&&l}),eT=Q.filter(e=>{var t,s,a;if(!ex)return!0;let l=ex.toLowerCase();return(null==(t=e.name)?void 0:t.toLowerCase().includes(l))||(null==(s=e.patient_id)?void 0:s.toLowerCase().includes(l))||(null==(a=e.phone)?void 0:a.includes(ex))});return u?(0,a.jsxs)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-5xl max-h-[95vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-4 flex-shrink-0",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold",children:"Book Appointment"}),(0,a.jsxs)("div",{className:"text-sm text-blue-100",children:["Step ",Y," of ",E.length,": ",null==(t=E[Y-1])?void 0:t.title,en&&Y>=3&&(0,a.jsxs)("span",{className:"ml-3 text-blue-100",children:["• ",en.name]})]})]}),(0,a.jsx)("button",{onClick:e_,className:"p-2 hover:bg-white/20 rounded-lg transition-all duration-200",children:(0,a.jsx)(f.A,{size:20})})]}),(0,a.jsx)("div",{className:"mt-3",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:E.map((e,t)=>{let s=e.icon,l=Y===e.id,r=Y>e.id;return(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"\n                        flex items-center justify-center w-8 h-8 rounded-full transition-all duration-300\n                        ".concat(r?"bg-white text-blue-600":l?"bg-white text-blue-600 ring-2 ring-white/50":"bg-blue-500 text-blue-200","\n                      "),children:r?(0,a.jsx)(d.A,{size:14}):(0,a.jsx)(s,{size:14})}),(0,a.jsx)("span",{className:"text-xs font-medium hidden sm:block ".concat(l||r?"text-white":"text-blue-200"),children:e.title})]}),t<E.length-1&&(0,a.jsx)("div",{className:"\n                        w-8 h-0.5 mx-2 rounded-full transition-all duration-500\n                        ".concat(r?"bg-white":"bg-blue-400/30","\n                      ")})]},e.id)})})})]}),(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,a.jsxs)("div",{className:"p-6",children:[H&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center",children:[(0,a.jsx)(x.A,{className:"text-red-500 mr-3",size:20}),(0,a.jsx)("span",{className:"text-red-700",children:H})]}),J&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[(0,a.jsx)(d.A,{className:"text-green-500 mr-3",size:20}),(0,a.jsx)("span",{className:"text-green-700",children:J})]}),1===Y&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"text-center mb-4",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Choose Your Doctor"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Select a doctor to proceed with your appointment booking"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Specialization"}),(0,a.jsxs)("select",{value:ed,onChange:e=>eo(e.target.value),className:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-sm",children:[(0,a.jsx)("option",{value:"",children:"All Specializations"}),F.map(e=>(0,a.jsx)("option",{value:e,children:e},e))]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Search Doctor"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,a.jsx)("input",{type:"text",placeholder:"Search by doctor name...",value:ec,onChange:e=>em(e.target.value),className:"w-full pl-10 pr-3 py-2 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-sm"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between bg-blue-50 p-3 rounded-lg",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-bold text-gray-900",children:"Available Doctors"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:[eP.length," doctors found"]})]}),(0,a.jsxs)("div",{className:"flex items-center bg-white px-3 py-1 rounded-lg shadow-sm",children:[(0,a.jsx)("input",{type:"checkbox",id:"emergency",checked:W.isEmergency,onChange:e=>Z(t=>({...t,isEmergency:e.target.checked})),className:"h-4 w-4 text-red-600 focus:ring-red-500 border-gray-300 rounded"}),(0,a.jsxs)("label",{htmlFor:"emergency",className:"ml-2 text-xs font-medium text-gray-700 flex items-center",children:[(0,a.jsx)(y.A,{className:"w-3 h-3 mr-1 text-red-500"}),"Emergency"]})]})]}),!el&&(0,a.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-3 rounded-r-lg",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(x.A,{className:"h-4 w-4 text-blue-400"}),(0,a.jsx)("div",{className:"ml-2",children:(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"Please select a doctor to continue to the next step."})})]})}),(0,a.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 max-h-[300px] overflow-y-auto pr-2",children:eP.map(e=>{var t,s,l;return(0,a.jsx)("div",{onClick:()=>eA(e),className:"\n                      group p-4 border rounded-lg cursor-pointer transition-all duration-300 hover:shadow-md\n                      ".concat((null==el?void 0:el.id)===e.id?"border-blue-500 bg-blue-50 shadow-sm ring-2 ring-blue-200":"border-gray-200 hover:border-blue-300 bg-white hover:bg-blue-50","\n                    "),children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center text-white font-bold text-sm transition-all duration-300 ".concat((null==el?void 0:el.id)===e.id?"bg-blue-600 shadow-sm":"bg-gray-600 group-hover:bg-blue-500"),children:(null==(s=e.user)||null==(t=s.name)?void 0:t[0])||"D"}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-bold text-sm text-gray-900 truncate",children:(null==(l=e.user)?void 0:l.name)||"Unknown Doctor"}),(0,a.jsx)("p",{className:"text-blue-600 font-medium text-xs truncate",children:e.specialization})]}),(null==el?void 0:el.id)===e.id&&(0,a.jsx)("div",{className:"bg-green-500 rounded-full p-0.5",children:(0,a.jsx)(d.A,{className:"text-white",size:14})})]}),(0,a.jsxs)("div",{className:"mt-2 space-y-1",children:[(0,a.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,a.jsx)(N.A,{size:12,className:"mr-1 text-gray-400"}),(0,a.jsxs)("span",{className:"font-medium",children:["Room ",e.room_number]})]}),(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center text-xs text-gray-600",children:[(0,a.jsx)(v.A,{size:12,className:"mr-1 text-green-500"}),(0,a.jsxs)("span",{className:"font-bold text-green-600",children:["₹",e.consultation_fee]})]})})]})]})]})},e.id)})}),0===eP.length&&(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gray-100 rounded-full mb-3",children:(0,a.jsx)(b.A,{className:"h-6 w-6 text-gray-400"})}),(0,a.jsx)("h3",{className:"text-sm font-semibold text-gray-900 mb-1",children:"No doctors found"}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:"Try adjusting your search criteria or specialization filter."})]})]}),2===Y&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:"Select Date & Time"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Choose your preferred appointment date and time with Dr. ",null==el||null==(s=el.user)?void 0:s.name]})]}),!el&&(0,a.jsx)("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-r-xl",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-red-400"}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-red-700",children:"Please go back and select a doctor first."})})]})}),el&&(0,a.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg",children:(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-10 h-10 bg-blue-600 rounded-lg flex items-center justify-center text-white font-bold text-sm",children:(null==(n=el.user)||null==(r=n.name)?void 0:r[0])||"D"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-bold text-gray-900",children:["Dr. ",null==(c=el.user)?void 0:c.name]}),(0,a.jsx)("p",{className:"text-blue-600 font-medium text-xs",children:el.specialization}),(0,a.jsxs)("p",{className:"text-gray-600 text-xs",children:["Room ",el.room_number," • ₹",el.consultation_fee]})]})]})}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800",children:"Select Date"}),(0,a.jsx)(P,{selectedDate:eu,onDateSelect:e=>{eg(e),Z(t=>({...t,appointmentDate:e})),el&&ew(el.id,e)},minDate:eM(),maxDate:ez(),disabledDates:(()=>{if(!el||!el.availability_hours)return[];try{let e=("string"==typeof el.availability_hours?JSON.parse(el.availability_hours):el.availability_hours).workingDays||[];if(0===e.length)return[];let t=[],s=new Date,a=new Date;a.setMonth(a.getMonth()+3);let l=e.map(e=>"number"==typeof e?e:({sunday:0,monday:1,tuesday:2,wednesday:3,thursday:4,friday:5,saturday:6})[e.toLowerCase()]).filter(e=>void 0!==e);for(let e=new Date(s);e<=a;e.setDate(e.getDate()+1)){let s=e.getDay();l.includes(s)||t.push(e.toISOString().split("T")[0])}return[...t,...es]}catch(e){return console.error("Error parsing doctor availability:",e),[]}})(),className:"w-full"}),!eu&&(0,a.jsx)("div",{className:"bg-blue-50 border-l-2 border-blue-400 p-3 rounded-r-lg",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(i.A,{className:"h-4 w-4 text-blue-400"}),(0,a.jsx)("div",{className:"ml-2",children:(0,a.jsx)("p",{className:"text-xs text-blue-700",children:"Please select a date to view available time slots."})})]})})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800",children:"Available Times"}),eu?B?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-blue-600 rounded-full mb-3",children:(0,a.jsx)(o.A,{className:"h-5 w-5 text-white animate-spin"})}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:"Loading available slots..."})]}):0===ee.morning.length&&0===ee.afternoon.length&&0===ee.evening.length?(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-10 h-10 bg-gray-100 rounded-full mb-3",children:(0,a.jsx)(o.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("p",{className:"text-sm font-semibold",children:"No available slots"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Please try selecting a different date."})]}):(0,a.jsx)("div",{className:"space-y-4",children:Object.entries(ee).map(e=>{let[t,s]=e;if(0===s.length)return null;let l={morning:{icon:"\uD83C\uDF05",label:"Morning (9:00 AM - 12:00 PM)",color:"from-blue-100 to-blue-50"},afternoon:{icon:"☀️",label:"Afternoon (2:00 PM - 5:00 PM)",color:"from-blue-100 to-cyan-100"},evening:{icon:"\uD83C\uDF19",label:"Evening (6:00 PM - 9:00 PM)",color:"from-purple-100 to-indigo-100"}}[t],r=W.sessionType===t;return(0,a.jsxs)("button",{type:"button",onClick:()=>eS(t),disabled:0===s.length,className:"p-4 rounded-lg text-center transition-all duration-200 shadow-sm hover:shadow-md\n                                ".concat(r?"bg-blue-600 text-white ring-2 ring-blue-200":"bg-gradient-to-r ".concat(l.color," hover:opacity-90")," \n                                ").concat(0===s.length?"opacity-50 cursor-not-allowed":"","\n                              "),children:[(0,a.jsx)("span",{className:"text-2xl mb-1 block",children:l.icon}),(0,a.jsx)("h5",{className:"font-bold text-sm mb-0.5",children:l.label}),(0,a.jsxs)("span",{className:"text-xs opacity-80 block",children:[s.length," slots available"]})]},t)})}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-6 text-center",children:[(0,a.jsx)(i.A,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),(0,a.jsx)("p",{className:"text-gray-500 text-sm",children:"Select a date to view available time slots"})]})]})]}),!W.appointmentTime&&eu&&(ee.morning.length>0||ee.afternoon.length>0||ee.evening.length>0)&&(0,a.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-xl",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(o.A,{className:"h-5 w-5 text-blue-400"}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-blue-700",children:"Please select a time slot to continue."})})]})})]}),3===Y&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Patient Information"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Choose an existing patient or register a new one"})]}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-3",children:"Search Patient"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(m.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16}),(0,a.jsx)("input",{type:"text",value:ex,onChange:e=>eh(e.target.value),placeholder:"Search by name, ID, or phone number...",className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-lg focus:ring-2 focus:ring-blue-100 focus:border-blue-500 transition-all duration-200 text-sm"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 mt-3",children:[(0,a.jsxs)("button",{onClick:()=>ef(!0),className:"flex items-center px-3 py-2 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-all duration-200 text-xs font-medium",children:[(0,a.jsx)(y.A,{size:14,className:"mr-1"}),"Emergency"]}),(0,a.jsxs)("button",{onClick:()=>eb(!0),className:"flex items-center px-3 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-all duration-200 text-xs font-medium",children:[(0,a.jsx)(w.A,{size:14,className:"mr-1"}),"New Patient"]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h4",{className:"text-sm font-semibold text-gray-800",children:"Available Patients"}),(0,a.jsxs)("span",{className:"text-xs text-gray-500",children:[eT.length," found"]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 max-h-80 overflow-y-auto",children:eT.map((e,t)=>{var s;return(0,a.jsx)("div",{onClick:()=>eC(e),className:"\n                        group relative p-4 border rounded-xl cursor-pointer transition-all duration-200\n                        ".concat((null==en?void 0:en.id)===e.id?"border-blue-500 bg-blue-50 shadow-sm":"border-gray-200 hover:border-blue-300 bg-white hover:shadow-sm","\n                      "),children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center font-medium text-sm ".concat((null==en?void 0:en.id)===e.id?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 group-hover:bg-blue-100 group-hover:text-blue-600"),children:(null==(s=e.name)?void 0:s[0])||"P"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 text-sm",children:e.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["ID: ",e.patient_id]}),(0,a.jsxs)("div",{className:"flex items-center mt-1 space-x-3",children:[(0,a.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,a.jsx)(A.A,{size:12,className:"mr-1"}),e.phone]}),e.email&&(0,a.jsxs)("div",{className:"flex items-center text-xs text-gray-500",children:[(0,a.jsx)(k.A,{size:12,className:"mr-1"}),e.email]})]}),e.date_of_birth&&(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(i.A,{size:14,className:"mr-1 text-gray-400"}),(0,a.jsxs)("span",{className:"text-sm text-gray-500",children:["Age: ",new Date().getFullYear()-new Date(e.date_of_birth).getFullYear()]})]})]})]}),(null==en?void 0:en.id)===e.id&&(0,a.jsx)("div",{className:"absolute -top-2 -right-2",children:(0,a.jsx)(d.A,{className:"w-8 h-8 text-blue-500 bg-white rounded-full shadow-md"})})]})},"patient-".concat(e.id,"-").concat(t))})}),0===eT.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-gray-100 rounded-full mb-4",children:(0,a.jsx)(g.A,{className:"h-8 w-8 text-gray-400"})}),(0,a.jsx)("p",{className:"text-lg font-semibold text-gray-600 mb-2",children:"No patients found"}),(0,a.jsx)("p",{className:"text-gray-500 mb-6",children:"No patients match your search criteria. Register a new patient to continue."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,a.jsxs)("button",{onClick:()=>ef(!0),className:"inline-flex items-center px-6 py-3 bg-red-500 text-white rounded-xl hover:bg-red-600 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl",children:[(0,a.jsx)(y.A,{size:20,className:"mr-2"}),"Emergency Registration"]}),(0,a.jsxs)("button",{onClick:()=>eb(!0),className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-orange-500 to-amber-600 text-white rounded-xl hover:from-orange-600 hover:to-amber-700 transition-all duration-200 font-semibold shadow-lg hover:shadow-xl",children:[(0,a.jsx)(w.A,{size:20,className:"mr-2"}),"Regular Registration"]})]})]}),!en&&eT.length>0&&(0,a.jsx)("div",{className:"bg-blue-50 border-l-4 border-blue-400 p-4 rounded-r-xl",children:(0,a.jsxs)("div",{className:"flex",children:[(0,a.jsx)(g.A,{className:"h-5 w-5 text-blue-400"}),(0,a.jsx)("div",{className:"ml-3",children:(0,a.jsx)("p",{className:"text-sm text-blue-700",children:"Please select a patient to continue with the appointment booking."})})]})})]})]}),4===Y&&(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Appointment Details"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Provide additional information about your appointment"})]}),en&&(0,a.jsx)("div",{className:"bg-blue-50 p-6 rounded-2xl border border-blue-200",children:(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-blue-600 rounded-2xl flex items-center justify-center",children:(0,a.jsx)(g.A,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-lg font-bold text-gray-900",children:["Appointment for: ",en.name]}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Patient ID: ",en.patient_id," • Phone: ",en.phone]})]})]})}),(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-3",children:"Appointment Type"}),(0,a.jsxs)("select",{value:W.type||"",onChange:e=>{let t=I.find(t=>t.value===e.target.value);t&&Z(e=>({...e,type:t.value,durationMinutes:t.duration}))},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[(0,a.jsx)("option",{value:"",children:"Select appointment type..."}),I.map(e=>(0,a.jsxs)("option",{value:e.value,children:[e.label," (",e.duration," min)"]},e.value))]}),!W.type&&(0,a.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Please select an appointment type"})]}),(0,a.jsxs)("div",{className:"bg-orange-50 p-4 rounded-xl",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Primary Reason for Visit *"}),(0,a.jsx)("textarea",{value:W.chiefComplaint||"",onChange:e=>Z(t=>({...t,chiefComplaint:e.target.value})),placeholder:"Describe the main reason for this appointment...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm resize-none",required:!0}),!W.chiefComplaint&&(0,a.jsx)("p",{className:"text-xs text-red-600 mt-1",children:"Please provide the primary reason for your visit"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 p-4 rounded-xl",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Current Symptoms"}),(0,a.jsx)("textarea",{value:W.symptoms||"",onChange:e=>Z(t=>({...t,symptoms:e.target.value})),placeholder:"List current symptoms...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm resize-none"})]}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-xl",children:[(0,a.jsx)("label",{className:"block text-sm font-semibold text-gray-800 mb-2",children:"Additional Notes"}),(0,a.jsx)("textarea",{value:W.notes||"",onChange:e=>Z(t=>({...t,notes:e.target.value})),placeholder:"Allergies, medications, special requests...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-gray-500 focus:border-gray-500 text-sm resize-none"})]})]})]}),5===Y&&(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"text-center mb-6",children:[(0,a.jsx)("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-gradient-to-br from-orange-400 to-amber-500 rounded-full mb-3",children:(0,a.jsx)(d.A,{className:"w-6 h-6 text-white"})}),(0,a.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"Confirm Your Appointment"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Please review the details below and confirm"})]}),(0,a.jsxs)("div",{className:"bg-gradient-to-br from-orange-50 via-amber-50 to-orange-100 p-6 rounded-2xl border border-gray-200 shadow-sm",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-500 to-amber-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(g.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:"Patient"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900 text-sm",children:null==en?void 0:en.name}),(0,a.jsxs)("div",{className:"text-xs text-gray-600",children:["ID: ",null==en?void 0:en.patient_id]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-500 to-amber-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(b.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:"Doctor"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("div",{className:"font-semibold text-gray-900 text-sm",children:["Dr. ",null==el||null==(h=el.user)?void 0:h.name]}),(0,a.jsx)("div",{className:"text-xs text-gray-600",children:null==el?void 0:el.specialization})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-500 to-amber-600 rounded-lg flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"w-4 h-4 text-white"})}),(0,a.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:"Date & Time"})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsx)("div",{className:"font-semibold text-gray-900 text-sm",children:new Date(W.appointmentDate).toLocaleDateString("en-US",{weekday:"short",month:"short",day:"numeric"})}),(0,a.jsxs)("div",{className:"text-xs text-gray-600 flex items-center justify-end",children:[(0,a.jsx)(o.A,{className:"w-3 h-3 mr-1"}),W.appointmentTime]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"p-3 bg-white rounded-xl shadow-sm text-center",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Type"}),(0,a.jsx)("div",{className:"font-semibold text-gray-900 text-sm capitalize",children:W.type.replace("_"," ")})]}),(0,a.jsxs)("div",{className:"p-3 bg-white rounded-xl shadow-sm text-center",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Duration"}),(0,a.jsxs)("div",{className:"font-semibold text-gray-900 text-sm",children:[W.durationMinutes," min"]})]}),(0,a.jsxs)("div",{className:"p-3 bg-white rounded-xl shadow-sm text-center",children:[(0,a.jsx)("div",{className:"text-xs text-gray-600 mb-1",children:"Fee"}),(0,a.jsxs)("div",{className:"font-semibold text-gray-900 text-sm text-green-600",children:["₹",null==el?void 0:el.consultation_fee]})]})]}),W.chiefComplaint&&(0,a.jsxs)("div",{className:"p-4 bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4 text-orange-600 mr-2"}),(0,a.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:"Primary Reason"})]}),(0,a.jsx)("p",{className:"text-gray-900 bg-gray-50 p-3 rounded-lg border-l-2 border-orange-500 text-sm",children:W.chiefComplaint})]}),W.symptoms&&(0,a.jsxs)("div",{className:"p-4 bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(x.A,{className:"w-4 h-4 text-orange-600 mr-2"}),(0,a.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:"Symptoms"})]}),(0,a.jsx)("p",{className:"text-gray-900 bg-gray-50 p-3 rounded-lg border-l-2 border-orange-500 text-sm",children:W.symptoms})]}),W.notes&&(0,a.jsxs)("div",{className:"p-4 bg-white rounded-xl shadow-sm",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsx)(j.A,{className:"w-4 h-4 text-orange-600 mr-2"}),(0,a.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:"Additional Notes"})]}),(0,a.jsx)("p",{className:"text-gray-900 bg-gray-50 p-3 rounded-lg border-l-2 border-orange-500 text-sm",children:W.notes})]})]}),(0,a.jsx)("div",{className:"mt-8 p-6 bg-gradient-to-r from-orange-100 to-amber-100 rounded-2xl border border-orange-200",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,a.jsx)(d.A,{className:"w-6 h-6 text-orange-600 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-orange-800 mb-2",children:"Ready to Book?"}),(0,a.jsx)("p",{className:"text-orange-700 text-sm",children:"By confirming this appointment, you agree to arrive 15 minutes early and bring any relevant medical documents. You will receive a confirmation message with appointment details."})]})]})})]})]})]})}),(0,a.jsxs)("div",{className:"bg-gradient-to-r from-gray-50 to-gray-100 px-8 py-6 flex items-center justify-between border-t border-gray-200 flex-shrink-0",children:[(0,a.jsxs)("button",{onClick:()=>{G(""),q(e=>Math.max(e-1,1))},disabled:1===Y,className:"flex items-center px-6 py-3 text-gray-600 hover:text-gray-800 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 rounded-xl hover:bg-gray-200 font-medium",children:[(0,a.jsx)(C.A,{size:20,className:"mr-2"}),"Previous"]}),(0,a.jsx)("div",{className:"flex items-center space-x-3",children:E.map((e,t)=>(0,a.jsx)("div",{className:"\n                  w-3 h-3 rounded-full transition-all duration-300\n                  ".concat(t+1<=Y?"bg-gradient-to-r from-orange-500 to-amber-600 shadow-lg":"bg-gray-300","\n                ")},t))}),Y<E.length?(0,a.jsxs)("button",{onClick:()=>{if(G(""),1===Y&&!el)return void G("Please select a doctor before proceeding to the next step.");if(2===Y){if(!W.appointmentDate)return void G("Please select an appointment date.");if(!W.appointmentTime)return void G("Please select an appointment time.")}if(3===Y&&!en)return void G("Please select a patient before proceeding.");if(4===Y){var e;if(!W.type)return void G("Please select an appointment type.");if(!(null==(e=W.chiefComplaint)?void 0:e.trim()))return void G("Please provide the chief complaint.")}q(e=>Math.min(e+1,E.length))},className:"flex items-center px-8 py-3 bg-gradient-to-r from-orange-500 to-amber-600 text-white rounded-xl hover:from-orange-600 hover:to-amber-700 transition-all duration-200 shadow-lg font-semibold",children:["Next",(0,a.jsx)(S.A,{size:20,className:"ml-2"})]}):(0,a.jsx)("button",{onClick:eD,disabled:B,className:"flex items-center px-8 py-3 bg-gradient-to-r from-green-500 to-emerald-600 text-white rounded-xl hover:from-green-600 hover:to-emerald-700 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 shadow-lg font-semibold",children:B?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-3"}),"Booking..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.A,{size:20,className:"mr-3"}),"Confirm Booking"]})})]})]}),ej&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:(0,a.jsx)(z.A,{onSubmit:async(e,t)=>{try{eN(!0);let s=await (0,_.DW)({firstName:e.firstName,lastName:e.lastName,dateOfBirth:e.dateOfBirth,gender:e.gender,phone:e.phone,email:"",address:e.address,bloodGroup:e.bloodGroup||"",allergies:e.allergies||"",medicalHistory:"",currentMedications:"",chronicConditions:"",previousSurgeries:"",admissionDate:e.admissionDate,admissionTime:e.admissionTime,primaryComplaint:e.primaryComplaint,admissionType:"emergency",referringDoctorFacility:"",consultingDoctorName:"",consultingDoctorId:"",departmentWard:"",roomNumber:"",guardianName:"",guardianRelationship:"",guardianPhone:"",guardianAddress:"",emergencyContactName:e.emergencyContactName||"",emergencyContactPhone:e.emergencyContactPhone||"",emergencyContactRelationship:e.emergencyContactRelationship||"",insuranceProvider:"",insuranceNumber:"",initialSymptoms:"",referredBy:""},t);if(s.success){let e={id:s.patient.id,patient_id:s.patient.patient_id,name:s.patient.name||"",phone:s.patient.phone,email:s.patient.email||"",date_of_birth:s.patient.date_of_birth,gender:s.patient.gender,status:s.patient.status};$(t=>[e,...t]),eC(e),ef(!1)}}catch(e){console.error("Error registering patient:",e)}finally{eN(!1)}},onCancel:()=>ef(!1),isLoading:ey})})})]}):null};function R(){let[e,t]=(0,l.useState)(!1),[s,b]=(0,l.useState)([]),[j,f]=(0,l.useState)({total:0,scheduled:0,completed:0,cancelled:0,todayCount:0,upcomingCount:0}),[y,N]=(0,l.useState)(!0),[v,w]=(0,l.useState)(null),[A,k]=(0,l.useState)(new Date().toISOString().split("T")[0]),[C,S]=(0,l.useState)(""),[_,M]=(0,l.useState)("all"),[z,P]=(0,l.useState)(null),T=async()=>{try{N(!0),w(null);let e=await (0,D.Xj)({date:A,searchTerm:C||void 0,status:"all"===_?void 0:_,limit:50});b(e.appointments)}catch(e){console.error("Error fetching appointments:",e),w("Failed to load appointments. Please try again.")}finally{N(!1)}},E=async()=>{try{let e=await (0,D.ZR)();f(e)}catch(e){console.error("Error fetching stats:",e)}},F=async(e,t)=>{try{P(e),await (0,D.H8)(e,t),await T(),await E()}catch(e){console.error("Error updating appointment status:",e),w("Failed to update appointment status. Please try again.")}finally{P(null)}},I=e=>{if(!e)return"N/A";let t=e.match(/Token:\s*(\d+)/);return t?t[1]:"N/A"},R=(e,t)=>{let s=new Date,a=new Date("".concat(e,"T").concat(t));if(s.toDateString()!==a.toDateString())return!1;let l=s.getTime()-a.getTime();return l>=-9e5&&l<=18e5};(0,l.useEffect)(()=>{T(),E()},[A,C,_]);let O=e=>{switch(e){case"scheduled":return"bg-blue-100 text-blue-800";case"confirmed":case"completed":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";case"in_progress":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},Y=e=>{switch(e){case"completed":return"from-green-500 to-green-600";case"cancelled":return"from-red-500 to-red-600";case"in_progress":return"from-yellow-500 to-yellow-600";default:return"from-blue-500 to-blue-600"}};return(0,a.jsxs)("div",{className:"space-y-6 p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Appointments"}),(0,a.jsx)("p",{className:"text-gray-500 mt-1",children:"Manage patient appointments and schedules"})]}),(0,a.jsxs)("button",{onClick:()=>t(!0),className:"flex items-center bg-orange-500 hover:bg-orange-600 text-white px-4 py-2.5 rounded-xl font-medium text-sm transition-all duration-200 shadow-sm hover:shadow-md",children:[(0,a.jsx)(r.A,{size:16,className:"mr-2"}),"New Appointment"]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsx)("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Today's Appointments"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.todayCount}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(n.A,{className:"h-3 w-3 text-green-500 mr-1"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-green-600",children:["Total: ",j.total]})]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-500 to-blue-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(i.A,{className:"text-white",size:20})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Completed"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.completed}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(d.A,{className:"h-3 w-3 text-green-500 mr-1"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-green-600",children:[j.total>0?Math.round(j.completed/j.total*100):0,"% success rate"]})]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-green-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(d.A,{className:"text-white",size:20})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Scheduled"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.scheduled}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(o.A,{className:"h-3 w-3 text-orange-500 mr-1"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-orange-600",children:["Upcoming: ",j.upcomingCount]})]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-orange-300 to-orange-400 rounded-xl flex items-center justify-center",children:(0,a.jsx)(o.A,{className:"text-white",size:20})})]})}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-600 uppercase tracking-wide",children:"Cancelled"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-gray-900 mt-1",children:j.cancelled}),(0,a.jsxs)("div",{className:"flex items-center mt-2",children:[(0,a.jsx)(c.A,{className:"h-3 w-3 text-red-500 mr-1"}),(0,a.jsxs)("span",{className:"text-sm font-medium text-red-600",children:[j.total>0?Math.round(j.cancelled/j.total*100):0,"% cancellation"]})]})]}),(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-red-500 to-red-600 rounded-xl flex items-center justify-center",children:(0,a.jsx)(c.A,{className:"text-white",size:20})})]})})]}),(0,a.jsx)("div",{className:"bg-white rounded-2xl p-5 shadow-sm border border-gray-100",children:(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(m.A,{className:"h-4 w-4 text-gray-400"})}),(0,a.jsx)("input",{type:"text",placeholder:"Search appointments by patient name, doctor, or ID...",value:C,onChange:e=>S(e.target.value),className:"w-full pl-10 pr-4 py-2.5 bg-gray-50 border border-gray-200 rounded-xl text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"flex items-center px-4 py-2.5 border border-gray-200 rounded-xl text-sm font-medium text-gray-700 bg-white",children:[(0,a.jsx)(i.A,{size:16,className:"mr-2"}),(0,a.jsx)("input",{type:"date",value:A,onChange:e=>k(e.target.value),className:"bg-transparent focus:outline-none"})]}),(0,a.jsxs)("select",{value:_,onChange:e=>M(e.target.value),className:"px-4 py-2.5 border border-gray-200 rounded-xl text-sm font-medium text-gray-700 bg-white focus:outline-none focus:ring-2 focus:ring-orange-500",children:[(0,a.jsx)("option",{value:"all",children:"All Status"}),(0,a.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,a.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,a.jsx)("option",{value:"completed",children:"Completed"}),(0,a.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,a.jsx)("option",{value:"in_progress",children:"In Progress"})]})]})]})}),v&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(x.A,{className:"h-5 w-5 text-red-500 mr-3"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-red-800 font-medium",children:"Error"}),(0,a.jsx)("p",{className:"text-red-700 text-sm",children:v})]}),(0,a.jsx)("button",{onClick:()=>w(null),className:"ml-auto text-red-500 hover:text-red-700",children:(0,a.jsx)(c.A,{className:"h-5 w-5"})})]})}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100",children:[(0,a.jsxs)("div",{className:"p-5 border-b border-gray-100",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:"Appointments"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Manage and track patient appointments"})]}),y?(0,a.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,a.jsx)(h.A,{className:"h-8 w-8 animate-spin text-orange-500"}),(0,a.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading appointments..."})]}):0===s.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(i.A,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"No appointments found for the selected criteria."})]}):(0,a.jsx)("div",{className:"divide-y divide-gray-100",children:s.map(e=>{var t,s,l;let r=I(e.notes||null),n=(null==(t=e.patient)?void 0:t.name)||"Unknown Patient",i=(null==(l=e.doctor)||null==(s=l.user)?void 0:s.name)||"Unknown Doctor",d=n.split(" ").map(e=>e.charAt(0)).join("").toUpperCase();return(0,a.jsx)("div",{className:"p-5 hover:bg-gray-50 transition-colors",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r ".concat(Y(e.status)," rounded-xl flex items-center justify-center"),children:(0,a.jsx)("span",{className:"text-white font-semibold text-sm",children:d})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900",children:n}),(0,a.jsx)("span",{className:"px-3 py-1 text-xs font-medium rounded-full ".concat(O(e.status)),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)}),"N/A"!==r&&(0,a.jsxs)("span",{className:"flex items-center px-2 py-1 bg-gray-100 text-gray-700 text-xs font-medium rounded-full",children:[(0,a.jsx)(u.A,{size:12,className:"mr-1"}),r]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4 mt-1 flex-wrap",children:[(0,a.jsxs)("span",{className:"text-sm text-gray-600 flex items-center",children:[(0,a.jsx)(o.A,{size:14,className:"mr-1"}),new Date(e.appointment_date).toLocaleDateString()," • ",e.appointment_time]}),(0,a.jsxs)("span",{className:"text-sm text-gray-600 flex items-center",children:[(0,a.jsx)(g.A,{size:14,className:"mr-1"}),i]}),e.chief_complaint&&(0,a.jsxs)("span",{className:"text-sm text-gray-600 flex items-center",children:[(0,a.jsx)("span",{className:"mr-1",children:"•"}),e.chief_complaint]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:["scheduled"===e.status&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>F(e.id,"completed"),disabled:z===e.id||!R(e.appointment_date,e.appointment_time),className:"px-3 py-1.5 text-xs font-medium rounded-lg transition-colors ".concat(R(e.appointment_date,e.appointment_time)?"bg-green-100 text-green-700 hover:bg-green-200":"bg-gray-100 text-gray-400 cursor-not-allowed"," disabled:opacity-50"),title:R(e.appointment_date,e.appointment_time)?"Mark appointment as completed":"Complete button is only active during appointment session (15 min before to 30 min after)",children:z===e.id?(0,a.jsx)(h.A,{className:"h-3 w-3 animate-spin"}):"Complete"}),(0,a.jsx)("button",{onClick:()=>F(e.id,"cancelled"),disabled:z===e.id,className:"px-3 py-1.5 bg-red-100 text-red-700 text-xs font-medium rounded-lg hover:bg-red-200 transition-colors disabled:opacity-50",children:z===e.id?(0,a.jsx)(h.A,{className:"h-3 w-3 animate-spin"}):"Cancel"})]}),(0,a.jsx)("button",{className:"p-2 text-gray-400 hover:text-gray-600 transition-colors",children:(0,a.jsx)(p.A,{size:16})})]})]})},e.id)})})]}),(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("button",{className:"bg-white border border-gray-200 text-gray-700 px-6 py-2.5 rounded-xl font-medium text-sm hover:bg-gray-50 transition-colors",children:"Load More Appointments"})}),e&&(0,a.jsx)("div",{className:"fixed inset-0 z-50 bg-white",children:(0,a.jsx)(L,{isOpen:!0,onClose:()=>t(!1),onSuccess:e=>{console.log("Appointment created:",e),T(),t(!1)}})})]})}},1154:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},1916:(e,t,s)=>{Promise.resolve().then(s.bind(s,861))},2355:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},3052:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("chevron-right",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]])},3109:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},4020:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("ellipsis-vertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]])},4516:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},4616:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},7434:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("file-text",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},7475:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("indian-rupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]])},7924:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},8883:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("mail",[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]])},9074:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(9946).A)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])}},e=>{var t=t=>e(e.s=t);e.O(0,[8800,774,9637,6,1172,8441,1684,7358],()=>t(1916)),_N_E=e.O()}]);