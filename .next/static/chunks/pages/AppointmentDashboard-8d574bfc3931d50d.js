(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7769],{7366:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/AppointmentDashboard",function(){return a(8035)}])},8035:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>X});var s=a(7876),n=a(4232),r=a(6563),i=a(1521),o=a(9763),l=a(9172),c=a(569),d=a(837),m=a(4315),p=a(2298),x=a(163),u=a(9050),h=a(405),g=a(758),y=a(179),b=a(3830),f=a(4916),j=a(4065),v=a(2288);let N=(0,a(3595).UU)("https://zusheijhebsmjiyyeiqq.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp1c2hlaWpoZWJzbWppeXllaXFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTE4MjI0NDAsImV4cCI6MjA2NzM5ODQ0MH0.iwGPaOJPa6OvwX_iA1xvRt5cM72DWfd8Br1pwRTemRc");async function w(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{page:t=1,limit:a=20,specialization:s,department:n,availabilityStatus:r,searchTerm:i,includeMD:o=!1}=e,l=(t-1)*a,c=N.from("doctors").select("\n        *,\n        user:users(id, name, email, phone, address)\n      ",{count:"exact"});if(s&&(c=c.eq("specialization",s)),n){let e={Cardiology:"Cardiology",Pediatrics:"Pediatrics",Orthopedics:"Orthopedics",Neurology:"Neurology",Dermatology:"Dermatology","Obstetrics & Gynecology":"Gynecology",Psychiatry:"Psychiatry",Radiology:"Radiology",Anesthesiology:"Anesthesiology",Emergency:"Emergency Medicine","Internal Medicine":"Internal Medicine",Surgery:"Surgery"}[n]||null;e&&(c=c.eq("specialization",e))}r&&(c=c.eq("status","active")),i&&(c=c.or("\n        license_number.ilike.%".concat(i,"%,\n        specialization.ilike.%").concat(i,"%\n      ")));let{data:d,error:m,count:p}=await c.range(l,l+a-1).order("created_at",{ascending:!1}),x=d||[];if(m)throw console.error("Error fetching doctors:",m),Error("Failed to fetch doctors: ".concat(m.message));return{doctors:(null==x?void 0:x.map(e=>({...e,doctor_id:e.license_number,department:k(e.specialization),experience_years:e.years_of_experience,working_hours_start:"09:00",working_hours_end:"17:00",working_days:[1,2,3,4,5,6],floor_number:1,availability_status:"available",emergency_available:!1})))||[],total:p||0,page:t,limit:a}}catch(e){throw console.error("Error fetching doctors:",e),e}}function k(e){return({Cardiology:"Cardiology",Pediatrics:"Pediatrics",Orthopedics:"Orthopedics",Neurology:"Neurology",Dermatology:"Dermatology",Gynecology:"Obstetrics & Gynecology",Psychiatry:"Psychiatry",Radiology:"Radiology",Anesthesiology:"Anesthesiology","Emergency Medicine":"Emergency","Internal Medicine":"Internal Medicine",Surgery:"Surgery",Oncology:"Oncology",Ophthalmology:"Ophthalmology",ENT:"ENT (Ear, Nose & Throat)",Urology:"Urology",Gastroenterology:"Gastroenterology",Endocrinology:"Endocrinology",Nephrology:"Nephrology",Pulmonology:"Pulmonology",Rheumatology:"Rheumatology",Hematology:"Hematology","Infectious Disease":"Infectious Disease",Pathology:"Pathology","Physical Medicine":"Physical Medicine & Rehabilitation","Plastic Surgery":"Plastic Surgery","Vascular Surgery":"Vascular Surgery","Thoracic Surgery":"Thoracic Surgery",Neurosurgery:"Neurosurgery",Dental:"Dental",Physiotherapy:"Physiotherapy",Nutrition:"Nutrition & Dietetics",Other:"Other"})[e]||e}async function D(e){try{let{data:t,error:a}=await supabase.from("doctors").select("\n        *,\n        user:users(id, name, email, phone, address)\n      ").eq("license_number",e).single();if(a)throw console.error("Error fetching doctor:",a),Error("Doctor not found: ".concat(a.message));return{...t,doctor_id:t.license_number,department:k(t.specialization),experience_years:t.years_of_experience,working_hours_start:"09:00",working_hours_end:"17:00",working_days:[1,2,3,4,5,6],floor_number:1,availability_status:"available",emergency_available:!1}}catch(e){throw console.error("Error fetching doctor:",e),e}}async function _(){try{let{data:e,error:t}=await N.from("doctors").select("specialization").eq("status","active");if(t)throw console.error("Error fetching specializations:",t),Error("Failed to fetch specializations: ".concat(t.message));return[...new Set((null==e?void 0:e.map(e=>e.specialization))||[])].sort()}catch(e){throw console.error("Error fetching specializations:",e),e}}let S={maxAppointmentsPerDay:30,minAdvanceBookingHours:0,maxAdvanceBookingDays:180,allowWeekendBooking:!0,emergencySlotBuffer:10,followUpGracePeriod:14,allowEmergencyBooking:!0,emergencyMaxAdvanceDays:30};async function A(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:S,a=[],s=[];e.patientId||a.push("Patient ID is required"),e.doctorId||a.push("Doctor ID is required"),e.appointmentDate||a.push("Appointment date is required"),e.appointmentTime||a.push("Appointment time is required");let n=new Date("".concat(e.appointmentDate,"T").concat(e.appointmentTime)),r=new Date,i=n.getDay();if(n<r&&a.push("Appointment cannot be scheduled in the past"),e.isEmergency&&t.allowEmergencyBooking)(n.getTime()-r.getTime())/864e5>t.emergencyMaxAdvanceDays&&a.push("Emergency appointments cannot be booked more than ".concat(t.emergencyMaxAdvanceDays," days in advance"));else{(n.getTime()-r.getTime())/864e5>t.maxAdvanceBookingDays&&a.push("Appointments cannot be booked more than ".concat(t.maxAdvanceBookingDays," days in advance")),t.allowWeekendBooking||0!==i&&6!==i||s.push("Weekend appointments may have limited availability");let e=n.getHours();(e<7||e>=20)&&s.push("Appointments outside 7:00 AM to 8:00 PM may have limited doctor availability")}return e.durationMinutes&&(e.durationMinutes<15||e.durationMinutes>120)&&a.push("Appointment duration must be between 15 and 120 minutes"),{isValid:0===a.length,errors:a,warnings:s}}async function C(e,t){let a=[],s=[];try{let n=new Date("".concat(e.appointmentDate,"T").concat(e.appointmentTime)),r=e.durationMinutes||30,i=new Date(n.getTime()+6e4*r),o=N.from("appointments").select("id, appointment_time, duration_minutes").eq("doctor_id",e.doctorId).eq("appointment_date",e.appointmentDate).in("status",["scheduled","confirmed","in_progress"]);t&&(o=o.neq("id",t));let{data:l,error:c}=await o;if(c)return a.push("Failed to check doctor availability"),{isValid:!1,errors:a,warnings:s};for(let t of l||[]){let s=new Date("".concat(e.appointmentDate,"T").concat(t.appointment_time)),r=new Date(s.getTime()+6e4*(t.duration_minutes||30));(n>=s&&n<r||i>s&&i<=r||n<=s&&i>=r)&&a.push("Doctor has a conflicting appointment at ".concat(t.appointment_time))}let d=N.from("appointments").select("id, appointment_time, duration_minutes").eq("patient_id",e.patientId).eq("appointment_date",e.appointmentDate).in("status",["scheduled","confirmed","in_progress"]);t&&(d=d.neq("id",t));let{data:m,error:p}=await d;if(p)return a.push("Failed to check patient availability"),{isValid:!1,errors:a,warnings:s};for(let t of m||[]){let s=new Date("".concat(e.appointmentDate,"T").concat(t.appointment_time)),r=new Date(s.getTime()+6e4*(t.duration_minutes||30));(n>=s&&n<r||i>s&&i<=r||n<=s&&i>=r)&&a.push("Patient has a conflicting appointment at ".concat(t.appointment_time))}let{count:x,error:u}=await N.from("appointments").select("id",{count:"exact",head:!0}).eq("doctor_id",e.doctorId).eq("appointment_date",e.appointmentDate).in("status",["scheduled","confirmed","in_progress"]);u?s.push("Could not verify daily appointment limit"):(x||0)>=S.maxAppointmentsPerDay&&a.push("Doctor has reached the maximum daily appointment limit (".concat(S.maxAppointmentsPerDay,")"))}catch(e){console.error("Error checking appointment conflicts:",e),a.push("Failed to validate appointment conflicts")}return{isValid:0===a.length,errors:a,warnings:s}}async function T(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:S,s=await A(e,a);if(!s.isValid)return s;let n=await C(e,t);return{isValid:s.isValid&&n.isValid,errors:[...s.errors,...n.errors],warnings:[...s.warnings,...n.warnings]}}function E(e){if(!e)return null;let t=e.match(/Token:\s*([A-Z]\d{3})/);return t?t[1]:null}async function M(){let e=new Date,t=e.getFullYear().toString(),a=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0"),n="".concat(t).concat(a).concat(s);try{let{count:e,error:t}=await N.from("appointments").select("id",{count:"exact",head:!0}).like("appointment_id","APT".concat(n,"%"));if(t)throw console.error("Error getting appointment count:",t),Error("Failed to generate appointment ID");let a=((e||0)+1).toString().padStart(4,"0");return"APT".concat(n).concat(a)}catch(e){throw console.error("Error generating appointment ID:",e),e}}async function z(e,t){try{let{count:a,error:s}=await N.from("appointments").select("id",{count:"exact",head:!0}).eq("doctor_id",e).eq("appointment_date",t).in("status",["scheduled","confirmed","in_progress","completed"]);if(s)throw console.error("Error getting appointment token count:",s),Error("Failed to generate appointment token");return(a||0)+1}catch(e){throw console.error("Error generating appointment token:",e),e}}async function I(e,t){try{let a=await T(e);if(!a.isValid){let e=a.errors.join("; ");throw Error("Appointment validation failed: ".concat(e))}a.warnings.length>0&&console.warn("Appointment warnings:",a.warnings.join("; "));let{data:s}=await N.from("doctors").select("id").eq("id",e.doctorId).single();if(!s)throw Error("Doctor with ID ".concat(e.doctorId," not found. Only registered doctors can have appointments."));let n=await M(),r=await z(e.doctorId,e.appointmentDate),i={appointment_id:n,patient_id:e.patientId,doctor_id:e.doctorId,appointment_date:e.appointmentDate,appointment_time:e.appointmentTime,duration_minutes:e.durationMinutes||30,type:e.type,status:"scheduled",symptoms:e.chiefComplaint||e.symptoms||null,notes:e.notes?"Token: ".concat(r," | ").concat(e.notes):"Token: ".concat(r),created_by:t||null},{data:o,error:l}=await N.from("appointments").insert([i]).select("\n        *,\n        patient:patients(id, patient_id, name, phone, email)\n      ").single();if(l)throw console.error("Error creating appointment:",l),Error("Failed to create appointment: ".concat(l.message));let{data:c}=await N.from("doctors").select("\n        id,\n        specialization,\n        qualification,\n        user:users(name, phone, email)\n      ").eq("id",e.doctorId).single();return{...o,doctor:c}}catch(e){throw console.error("Error creating appointment:",e),e}}async function P(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{page:t=1,limit:a=20,patientId:s,doctorId:n,date:r,status:i,type:o,searchTerm:l}=e,c=(t-1)*a,d=N.from("appointments").select("\n        *,\n        patient:patients(id, patient_id, name, phone, email)\n      ",{count:"exact"});s&&(d=d.eq("patient_id",s)),n&&(d=d.eq("doctor_id",n)),r&&(d=d.eq("appointment_date",r)),i&&(d=d.eq("status",i)),o&&(d=d.eq("type",o)),l&&(d=d.or("\n        appointment_id.ilike.%".concat(l,"%,\n        symptoms.ilike.%").concat(l,"%,\n        chief_complaint.ilike.%").concat(l,"%,\n        diagnosis.ilike.%").concat(l,"%\n      ")));let{data:m,error:p,count:x}=await d.range(c,c+a-1).order("appointment_date",{ascending:!1}).order("appointment_time",{ascending:!1});if(p)throw console.error("Error fetching appointments:",p),Error("Failed to fetch appointments: ".concat(p.message));return{appointments:await Promise.all((m||[]).map(async e=>{let t=null,{data:a}=await N.from("doctors").select("\n            id,\n            specialization,\n            qualification,\n            user:users(name, phone, email)\n          ").eq("id",e.doctor_id).single();return a&&(t=a),{...e,doctor:t}})),total:x||0,page:t,limit:a}}catch(e){throw console.error("Error fetching appointments:",e),e}}async function q(e,t){try{let{data:a,error:s}=await N.from("appointments").update({status:t}).eq("appointment_id",e).select("\n        *,\n        patient:patients(id, patient_id, name, phone, email),\n        doctor:doctors(\n          id,\n          specialization,\n          user:users(name, phone, email)\n        )\n      ").single();if(s)throw console.error("Error updating appointment status:",s),Error("Failed to update appointment status: ".concat(s.message));return a}catch(e){throw console.error("Error updating appointment status:",e),e}}async function F(e,t){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{let n=null,r=null,{data:i,error:o}=await N.from("doctors").select("\n        *,\n        user:users(name, role)\n      ").eq("id",e).single();if(i?n=i:r=o,r||!n)throw console.error("Error fetching doctor:",r),Error("Doctor not found: ".concat((null==r?void 0:r.message)||"Doctor does not exist"));let{data:l,error:c}=await N.from("appointments").select("appointment_time, duration_minutes").eq("doctor_id",e).eq("appointment_date",t).in("status",["scheduled","confirmed","in_progress"]);if(c)throw console.error("Error fetching existing appointments:",c),Error("Failed to fetch existing appointments: ".concat(c.message));let d=[],m=n.availability_hours;if(!m||!m.sessions||!m.availableSessions)return console.warn("Doctor has no session-based availability configured"),d;let p=new Date(t).getDay();if(!(m.workingDays||[]).includes(p))return d;if(a){for(let a=0;a<24;a++)for(let r=0;r<60;r+=30){var s;let i="".concat(a.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")),o=null==l?void 0:l.some(e=>{let t=e.appointment_time,a=e.duration_minutes||30,s=new Date("2000-01-01T".concat(t));s.setMinutes(s.getMinutes()+a);let n=new Date("2000-01-01T".concat(i)),r=new Date(n);return r.setMinutes(r.getMinutes()+30),n<s&&r>new Date("2000-01-01T".concat(t))});d.push({date:t,time:i,available:!o,doctorId:e,doctorName:(null==(s=n.user)?void 0:s.name)||"Unknown",specialization:n.specialization,isEmergency:!0})}return d}let x={morning:{start:"09:00",end:"12:00"},afternoon:{start:"14:00",end:"17:00"},evening:{start:"18:00",end:"21:00"}};return m.availableSessions.forEach(a=>{var s,r,i;let o=m.sessions[a],c=x[a];if(!o||!c)return;let p=parseInt((null==(s=o.startTime)?void 0:s.split(":")[0])||c.start.split(":")[0]),u=parseInt((null==(r=o.endTime)?void 0:r.split(":")[0])||c.end.split(":")[0]),h=o.maxPatients||8,g=Math.floor((u-p)*60/30),y=Math.min(g,h),b=0;for(let s=p;s<u&&b<y;s++)for(let r=0;r<60&&b<y;r+=30){let o="".concat(s.toString().padStart(2,"0"),":").concat(r.toString().padStart(2,"0")),c=null==l?void 0:l.some(e=>{let t=e.appointment_time,a=e.duration_minutes||30,s=new Date("2000-01-01T".concat(t));s.setMinutes(s.getMinutes()+a);let n=new Date("2000-01-01T".concat(o)),r=new Date(n);return r.setMinutes(r.getMinutes()+30),n<s&&r>new Date("2000-01-01T".concat(t))});d.push({date:t,time:o,available:!c,doctorId:e,doctorName:(null==(i=n.user)?void 0:i.name)||"Unknown",specialization:n.specialization,sessionType:a}),b++}}),d}catch(e){throw console.error("Error generating available slots:",e),e}}async function O(e,t){try{let a={status:"cancelled"};t&&(a.notes=t);let{data:s,error:n}=await N.from("appointments").update(a).eq("appointment_id",e).select("\n        *,\n        patient:patients(id, patient_id, name, phone, email),\n        doctor:doctors(\n          id, \n          doctor_id, \n          specialization, \n          department,\n          user:users(name, phone, email)\n        )\n      ").single();if(n)throw console.error("Error cancelling appointment:",n),Error("Failed to cancel appointment: ".concat(n.message));return s}catch(e){throw console.error("Error cancelling appointment:",e),e}}async function B(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};try{let{page:t=1,limit:a=20,status:s,searchTerm:n}=e,r=(t-1)*a,i=N.from("patients").select("\n        *,\n        users:user_id (\n          id,\n          name,\n          email,\n          role,\n          status,\n          permissions\n        )\n      ",{count:"exact"});s&&(i=i.eq("status",s)),n&&(i=i.or("name.ilike.%".concat(n,"%,patient_id.ilike.%").concat(n,"%,phone.ilike.%").concat(n,"%")));let{data:o,error:l,count:c}=await i.range(r,r+a-1).order("created_at",{ascending:!1});if(l)throw console.error("Error fetching patients:",l),Error("Failed to fetch patients: ".concat(l.message));return{patients:o||[],total:c||0,page:t,limit:a}}catch(e){throw console.error("Error fetching patients:",e),e}}let L=e=>{var t,a,o;let{isOpen:l,onClose:c,onSuccess:d,patientId:N,doctorId:k}=e,[D,S]=(0,n.useState)(1),[A,C]=(0,n.useState)(!1),[T,M]=(0,n.useState)(""),[z,P]=(0,n.useState)(""),[q,O]=(0,n.useState)({patientId:N||"",doctorId:k||"",appointmentDate:"",appointmentTime:"",durationMinutes:30,type:"consultation",symptoms:"",notes:"",isEmergency:!1,sessionType:"morning"}),[L,R]=(0,n.useState)([]),[U,V]=(0,n.useState)([]),[J,W]=(0,n.useState)([]),[G,X]=(0,n.useState)(""),[H,Y]=(0,n.useState)([]),[Z,Q]=(0,n.useState)(null),[K,$]=(0,n.useState)(null),[ee,et]=(0,n.useState)(""),[ea,es]=(0,n.useState)(""),[en,er]=(0,n.useState)(!1);(0,n.useEffect)(()=>{l&&ei()},[l]),(0,n.useEffect)(()=>{q.doctorId&&q.appointmentDate&&eo()},[q.doctorId,q.appointmentDate,q.isEmergency]);let ei=async()=>{try{var e,t;C(!0);let[a,s,n]=await Promise.all([B({limit:100}),w(),_()]);if(R(a.patients||[]),V(s.doctors||[]),W(n||[]),N){let t=null==(e=a.patients)?void 0:e.find(e=>e.id===N);t&&$(t)}if(k){let e=null==(t=s.doctors)?void 0:t.find(e=>e.id===k);e&&(Q(e),X(e.specialization))}}catch(e){console.error("Error loading initial data:",e),M("Failed to load data. Please try again.")}finally{C(!1)}},eo=async()=>{try{let e=await F(q.doctorId,q.appointmentDate,q.isEmergency);Y(e.map(e=>({time:e.time,available:e.available})))}catch(e){console.error("Error loading available slots:",e),M("Failed to load available time slots.")}},el=async e=>{if(e.preventDefault(),!q.patientId||!q.doctorId||!q.appointmentDate||!q.appointmentTime)return void M("Please fill in all required fields.");try{C(!0),M("");let e=await I(q),t=E(null==e?void 0:e.notes);P(t?"Appointment for ".concat(null==K?void 0:K.first_name," ").concat(null==K?void 0:K.last_name," booked successfully! Your token number is ").concat(t,"."):"Appointment for ".concat(null==K?void 0:K.first_name," ").concat(null==K?void 0:K.last_name," booked successfully!")),setTimeout(()=>{null==d||d(e),ec()},1500)}catch(e){console.error("Error creating appointment:",e),M(e.message||"Failed to book appointment. Please try again.")}finally{C(!1)}},ec=()=>{S(1),O({patientId:"",doctorId:"",appointmentDate:"",appointmentTime:"",durationMinutes:30,type:"consultation",symptoms:"",notes:"",isEmergency:!1,sessionType:"morning"}),M(""),P(""),$(null),Q(null),X(""),et(""),es(""),er(!1),c()},ed=L.filter(e=>"".concat(e.first_name," ").concat(e.last_name).toLowerCase().includes(ee.toLowerCase())||e.patient_id.toLowerCase().includes(ee.toLowerCase())||e.phone.includes(ee)),em=U.filter(e=>{var t,a;let s=(null==(a=e.user)||null==(t=a.name)?void 0:t.toLowerCase().includes(ea.toLowerCase()))||e.license_number.toLowerCase().includes(ea.toLowerCase()),n=!G||e.specialization===G;return s&&n});return l?(0,s.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 backdrop-blur-sm",children:(0,s.jsx)("div",{className:"flex min-h-screen items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"w-full max-w-4xl bg-white rounded-3xl shadow-2xl border border-gray-100 overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-white px-8 py-6 border-b border-gray-200",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-800",children:"Book New Appointment"}),(0,s.jsxs)("p",{className:"text-gray-500 mt-1 text-sm",children:["Step ",D," of 4: ",["Select Patient","Select Doctor","Select Date & Time","Confirm Details"][D-1]]})]}),(0,s.jsx)("button",{onClick:ec,className:"p-2 text-gray-500 hover:bg-gray-100 rounded-full transition-colors",children:(0,s.jsx)(m.A,{size:24})})]}),(0,s.jsx)("div",{className:"mt-4 bg-gray-200 rounded-full h-2",children:(0,s.jsx)("div",{className:"bg-orange-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(D/4*100,"%")}})})]}),(0,s.jsxs)("div",{className:"p-8",children:[T&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-center",children:[(0,s.jsx)(p.A,{className:"text-red-500 mr-3",size:20}),(0,s.jsx)("span",{className:"text-red-700",children:T})]}),z&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-xl flex items-center",children:[(0,s.jsx)(x.A,{className:"text-green-500 mr-3",size:20}),(0,s.jsx)("span",{className:"text-green-700",children:z})]}),(0,s.jsxs)("form",{onSubmit:el,className:"space-y-6",children:[1===D&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(u.A,{className:"mx-auto h-12 w-12 text-orange-500 mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Select Patient"}),(0,s.jsx)("p",{className:"text-gray-500 mt-2",children:"Choose the patient for this appointment"})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)("input",{type:"text",placeholder:"Search by name, patient ID, or phone...",value:ee,onChange:e=>et(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto space-y-2",children:ed.map(e=>(0,s.jsx)("div",{onClick:()=>{$(e),O(t=>({...t,patientId:e.id}))},className:"p-4 border rounded-xl cursor-pointer transition-all ".concat((null==K?void 0:K.id)===e.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h4",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["ID: ",e.patient_id]}),(0,s.jsxs)("p",{className:"text-sm text-gray-500",children:["Phone: ",e.phone]})]}),(null==K?void 0:K.id)===e.id&&(0,s.jsx)(x.A,{className:"text-orange-500",size:20})]})},e.id))}),(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsx)("button",{type:"button",onClick:()=>S(2),disabled:!K,className:"px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next: Select Doctor"})})]}),2===D&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(g.A,{className:"mx-auto h-12 w-12 text-orange-500 mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Select Doctor"}),(0,s.jsx)("p",{className:"text-gray-500 mt-2",children:"Choose a doctor for the consultation"})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)("input",{type:"text",placeholder:"Search doctors...",value:ea,onChange:e=>es(e.target.value),className:"w-full pl-12 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,s.jsxs)("select",{value:G,onChange:e=>X(e.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,s.jsx)("option",{value:"",children:"All Specializations"}),J.map(e=>(0,s.jsx)("option",{value:e,children:e},e))]})]}),(0,s.jsx)("div",{className:"max-h-64 overflow-y-auto space-y-3",children:em.map(e=>{var t;return(0,s.jsx)("div",{onClick:()=>{Q(e),O(t=>({...t,doctorId:e.id}))},className:"p-4 border rounded-xl cursor-pointer transition-all ".concat((null==Z?void 0:Z.id)===e.id?"border-orange-500 bg-orange-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:(null==(t=e.user)?void 0:t.name)||"Unknown Doctor"}),(0,s.jsx)("p",{className:"text-sm text-gray-600",children:e.specialization}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:e.qualification}),(0,s.jsxs)("div",{className:"flex items-center mt-2 space-x-4",children:[(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,s.jsx)(y.A,{size:14,className:"mr-1"}),e.room_number]}),(0,s.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,s.jsx)(b.A,{size:14,className:"mr-1"}),"₹",e.consultation_fee]})]})]}),(null==Z?void 0:Z.id)===e.id&&(0,s.jsx)(x.A,{className:"text-orange-500",size:20})]})},e.id)})}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{type:"button",onClick:()=>S(1),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"Back"}),(0,s.jsx)("button",{type:"button",onClick:()=>S(3),disabled:!Z,className:"px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next: Select Date & Time"})]})]}),3===D&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(r.A,{className:"mx-auto h-12 w-12 text-orange-500 mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Select Date & Time"}),K&&(0,s.jsxs)("p",{className:"text-gray-500 mt-2",children:["For: ",K.first_name," ",K.last_name]})]}),(0,s.jsx)("div",{className:"bg-gray-50 p-4 rounded-xl",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,s.jsx)(f.A,{className:"text-red-500",size:20}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900",children:"Emergency Appointment"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Available 24/7 with flexible scheduling"})]})]}),(0,s.jsxs)("label",{className:"relative inline-flex items-center cursor-pointer",children:[(0,s.jsx)("input",{type:"checkbox",checked:en,onChange:e=>{er(e.target.checked),O(t=>({...t,isEmergency:e.target.checked}))},className:"sr-only peer"}),(0,s.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-orange-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-orange-500"})]})]})}),!en&&(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Preferred Session"}),(0,s.jsx)("div",{className:"grid grid-cols-3 gap-3",children:["morning","afternoon","evening"].map(e=>(0,s.jsxs)("button",{type:"button",onClick:()=>O(t=>({...t,sessionType:e})),className:"p-3 border rounded-xl text-center transition-all ".concat(q.sessionType===e?"border-orange-500 bg-orange-50 text-orange-700":"border-gray-200 hover:border-gray-300 text-gray-700"),children:[(0,s.jsx)("div",{className:"font-medium capitalize",children:e}),(0,s.jsxs)("div",{className:"text-xs text-gray-500 mt-1",children:["morning"===e&&"9:00 AM - 12:00 PM","afternoon"===e&&"2:00 PM - 5:00 PM","evening"===e&&"6:00 PM - 9:00 PM"]})]},e))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Appointment Date",Z&&(0,s.jsxs)("span",{className:"text-xs text-gray-500 ml-2",children:["(Available on: ",(null==(a=Z.availability_hours)||null==(t=a.workingDays)?void 0:t.map(e=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][e]).join(", "))||"Mon-Sat",")"]})]}),(0,s.jsx)("input",{type:"date",min:new Date().toISOString().split("T")[0],max:(()=>{let e=new Date;return e.setMonth(e.getMonth()+3),e.toISOString().split("T")[0]})(),value:q.appointmentDate,onChange:e=>O(t=>({...t,appointmentDate:e.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",required:!0}),Z&&q.appointmentDate&&(0,s.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:(()=>{var e;if(!Z)return[];let t=[],a=new Date,s=new Date;s.setMonth(s.getMonth()+3);let n=(null==(e=Z.availability_hours)?void 0:e.workingDays)||[1,2,3,4,5,6];for(let e=new Date(a);e<=s;e.setDate(e.getDate()+1)){let a=e.getDay();n.includes(a)&&t.push(e.toISOString().split("T")[0])}return t})().includes(q.appointmentDate)?"✓ Doctor available on this date":"⚠️ Doctor may not be available on this date"})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Appointment Type"}),(0,s.jsxs)("select",{value:q.type,onChange:e=>O(t=>({...t,type:e.target.value})),className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,s.jsx)("option",{value:"consultation",children:"Consultation"}),(0,s.jsx)("option",{value:"follow_up",children:"Follow-up"}),(0,s.jsx)("option",{value:"routine_checkup",children:"Routine Checkup"}),(0,s.jsx)("option",{value:"emergency",children:"Emergency"})]})]})]}),q.appointmentDate&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:["Available Time Slots",(0,s.jsx)("span",{className:"text-xs text-gray-500 ml-2",children:"(Real-time availability - can book up to 5 minutes before)"})]}),0===H.length?(0,s.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,s.jsx)(i.A,{className:"mx-auto h-8 w-8 mb-2"}),(0,s.jsx)("p",{children:"Loading available time slots..."})]}):(0,s.jsx)("div",{className:"grid grid-cols-3 md:grid-cols-4 gap-3",children:(e=>{let t=new Date,a=t.toISOString().split("T")[0];if(q.appointmentDate!==a)return e;let s=new Date(t.getTime()+3e5),n="".concat(s.getHours().toString().padStart(2,"0"),":").concat(s.getMinutes().toString().padStart(2,"0"));return e.filter(e=>!e.available||e.time>=n)})(H).map(e=>(0,s.jsxs)("button",{type:"button",disabled:!e.available,onClick:()=>O(t=>({...t,appointmentTime:e.time})),className:"p-3 text-sm font-medium rounded-xl transition-all ".concat(q.appointmentTime===e.time?"bg-orange-500 text-white":e.available?"bg-gray-50 text-gray-700 hover:bg-gray-100 border border-gray-200":"bg-gray-100 text-gray-400 cursor-not-allowed"),children:[(0,s.jsx)(i.A,{size:14,className:"inline mr-1"}),e.time,!e.available&&(0,s.jsx)("div",{className:"text-xs mt-1",children:"Booked"})]},e.time))}),q.appointmentDate===new Date().toISOString().split("T")[0]&&(0,s.jsx)("p",{className:"text-xs text-blue-600 mt-2",children:"ℹ️ For today's appointments, only future time slots (5+ minutes from now) are shown"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{type:"button",onClick:()=>S(2),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"Back"}),(0,s.jsx)("button",{type:"button",onClick:()=>S(4),disabled:!q.appointmentDate||!q.appointmentTime,className:"px-6 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:"Next: Additional Details"})]})]}),4===D&&(0,s.jsxs)("div",{className:"space-y-6",children:[(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(x.A,{className:"mx-auto h-12 w-12 text-orange-500 mb-4"}),(0,s.jsx)("h3",{className:"text-xl font-semibold text-gray-900",children:"Additional Details"}),K&&(0,s.jsxs)("p",{className:"text-gray-500 mt-2",children:["For: ",K.first_name," ",K.last_name]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Symptoms or Chief Complaint"}),(0,s.jsx)("textarea",{value:q.symptoms,onChange:e=>O(t=>({...t,symptoms:e.target.value})),rows:3,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Describe the main symptoms or reason for visit..."})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Additional Notes"}),(0,s.jsx)("textarea",{value:q.notes,onChange:e=>O(t=>({...t,notes:e.target.value})),rows:2,className:"w-full px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Any additional information or special requests..."})]})]}),(0,s.jsxs)("div",{className:"bg-gray-50 p-6 rounded-xl",children:[(0,s.jsx)("h4",{className:"font-medium text-gray-900 mb-4",children:"Appointment Summary"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Patient:"}),(0,s.jsxs)("span",{className:"font-medium",children:[null==K?void 0:K.first_name," ",null==K?void 0:K.last_name]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Doctor:"}),(0,s.jsx)("span",{className:"font-medium",children:(null==Z||null==(o=Z.user)?void 0:o.name)||"Unknown Doctor"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Specialization:"}),(0,s.jsx)("span",{className:"font-medium",children:null==Z?void 0:Z.specialization})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Date & Time:"}),(0,s.jsxs)("span",{className:"font-medium",children:[new Date(q.appointmentDate).toLocaleDateString()," at ",q.appointmentTime]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Type:"}),(0,s.jsx)("span",{className:"font-medium capitalize",children:q.type.replace("_"," ")})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600",children:"Consultation Fee:"}),(0,s.jsxs)("span",{className:"font-medium",children:["₹",null==Z?void 0:Z.consultation_fee]})]})]})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("button",{type:"button",onClick:()=>S(3),className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-xl hover:bg-gray-50 transition-colors",children:"Back"}),(0,s.jsx)("button",{type:"submit",disabled:A,className:"px-8 py-3 bg-orange-500 text-white rounded-xl hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center",children:A?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(j.A,{className:"animate-spin mr-2",size:20}),"Booking..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v.A,{className:"mr-2",size:20}),"Book Appointment"]})})]})]})]})]})]})})}):null};var R=a(1400),U=a(4749),V=a(3147),J=a(3974),W=a(2387);let G=()=>{let[e,t]=(0,n.useState)([]),[a,o]=(0,n.useState)(!0),[l,d]=(0,n.useState)(""),[m,y]=(0,n.useState)(!1),[b,f]=(0,n.useState)(""),[j,v]=(0,n.useState)("all"),[N,k]=(0,n.useState)("today"),[D,_]=(0,n.useState)(""),[S,A]=(0,n.useState)(1),[C]=(0,n.useState)(10),[T,M]=(0,n.useState)(0),[z,I]=(0,n.useState)([]),[F,B]=(0,n.useState)(null),[G,X]=(0,n.useState)(null);(0,n.useEffect)(()=>{H(),Y()},[S,j,N,D,b]);let H=async()=>{try{o(!0),d("");let e={page:S,limit:C};"all"!==j&&(e.status=j),D&&(e.doctorId=D),b&&(e.searchTerm=b);let a=new Date;if("today"===N)e.date=a.toISOString().split("T")[0];else if("week"===N){let t=new Date(a);t.setDate(a.getDate()-a.getDay()),e.dateFrom=t.toISOString().split("T")[0];let s=new Date(t);s.setDate(t.getDate()+6),e.dateTo=s.toISOString().split("T")[0]}else if("month"===N){let t=new Date(a.getFullYear(),a.getMonth(),1),s=new Date(a.getFullYear(),a.getMonth()+1,0);e.dateFrom=t.toISOString().split("T")[0],e.dateTo=s.toISOString().split("T")[0]}let s=await P(e);t(s.appointments||[]),M(s.total||0)}catch(e){console.error("Error loading appointments:",e),d("Failed to load appointments. Please try again.")}finally{o(!1)}},Y=async()=>{try{let e=await w();I(e.doctors||[])}catch(e){console.error("Error loading doctors:",e)}},Z=async(e,t)=>{try{await q(e,t),await H(),X(null)}catch(e){console.error("Error updating appointment status:",e),d("Failed to update appointment status.")}},Q=async e=>{if(confirm("Are you sure you want to cancel this appointment?"))try{await O(e,"Cancelled by staff"),await H(),X(null)}catch(e){console.error("Error cancelling appointment:",e),d("Failed to cancel appointment.")}},K=e=>{switch(e.toLowerCase()){case"confirmed":return"bg-blue-100 text-blue-800 border-blue-200";case"completed":return"bg-green-100 text-green-800 border-green-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";case"no_show":return"bg-gray-100 text-gray-800 border-gray-200";case"rescheduled":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-orange-100 text-orange-800 border-orange-200"}},$=e=>{switch(e.toLowerCase()){case"confirmed":case"completed":return(0,s.jsx)(x.A,{size:14});case"cancelled":return(0,s.jsx)(R.A,{size:14});case"no_show":return(0,s.jsx)(p.A,{size:14});case"rescheduled":return(0,s.jsx)(U.A,{size:14});default:return(0,s.jsx)(i.A,{size:14})}},ee=e=>new Date(e).toLocaleDateString("en-US",{weekday:"short",year:"numeric",month:"short",day:"numeric"}),et=e=>new Date("2000-01-01T".concat(e)).toLocaleTimeString("en-US",{hour:"numeric",minute:"2-digit",hour12:!0}),ea=Math.ceil(T/C),es=(()=>{let t=new Date().toISOString().split("T")[0],a=e.filter(e=>e.appointment_date===t);return{total:e.length,today:a.length,confirmed:e.filter(e=>"confirmed"===e.status).length,completed:e.filter(e=>"completed"===e.status).length,cancelled:e.filter(e=>"cancelled"===e.status).length}})();return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 via-white to-orange-50",children:[(0,s.jsx)("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,s.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)(r.A,{className:"h-8 w-8 text-orange-500 mr-3"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Appointment Management"}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"Manage patient appointments and schedules"})]})]}),(0,s.jsxs)("button",{onClick:()=>y(!0),className:"inline-flex items-center px-4 py-2 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-colors shadow-sm",children:[(0,s.jsx)(c.A,{size:20,className:"mr-2"}),"New Appointment"]})]})})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-6 mb-8",children:[(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 bg-blue-100 rounded-xl",children:(0,s.jsx)(r.A,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Total"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:es.total})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 bg-orange-100 rounded-xl",children:(0,s.jsx)(i.A,{className:"h-6 w-6 text-orange-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Today"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:es.today})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 bg-blue-100 rounded-xl",children:(0,s.jsx)(x.A,{className:"h-6 w-6 text-blue-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Confirmed"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:es.confirmed})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 bg-green-100 rounded-xl",children:(0,s.jsx)(x.A,{className:"h-6 w-6 text-green-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Completed"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:es.completed})]})]})}),(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"p-3 bg-red-100 rounded-xl",children:(0,s.jsx)(R.A,{className:"h-6 w-6 text-red-600"})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Cancelled"}),(0,s.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:es.cancelled})]})]})})]}),(0,s.jsx)("div",{className:"bg-white rounded-2xl p-6 shadow-sm border border-gray-100 mb-8",children:(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(h.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),(0,s.jsx)("input",{type:"text",placeholder:"Search appointments...",value:b,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,s.jsxs)("select",{value:j,onChange:e=>v(e.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,s.jsx)("option",{value:"all",children:"All Status"}),(0,s.jsx)("option",{value:"scheduled",children:"Scheduled"}),(0,s.jsx)("option",{value:"confirmed",children:"Confirmed"}),(0,s.jsx)("option",{value:"completed",children:"Completed"}),(0,s.jsx)("option",{value:"cancelled",children:"Cancelled"}),(0,s.jsx)("option",{value:"no_show",children:"No Show"})]}),(0,s.jsxs)("select",{value:N,onChange:e=>k(e.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,s.jsx)("option",{value:"all",children:"All Dates"}),(0,s.jsx)("option",{value:"today",children:"Today"}),(0,s.jsx)("option",{value:"week",children:"This Week"}),(0,s.jsx)("option",{value:"month",children:"This Month"})]}),(0,s.jsxs)("select",{value:D,onChange:e=>_(e.target.value),className:"px-4 py-3 border border-gray-200 rounded-xl focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,s.jsx)("option",{value:"",children:"All Doctors"}),z.map(e=>{var t;return(0,s.jsxs)("option",{value:e.id,children:[(null==(t=e.user)?void 0:t.name)||"Unknown Doctor"," - ",e.specialization]},e.id)})]})]})}),l&&(0,s.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-xl flex items-center",children:[(0,s.jsx)(p.A,{className:"text-red-500 mr-3",size:20}),(0,s.jsx)("span",{className:"text-red-700",children:l})]}),(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-sm border border-gray-100 overflow-hidden",children:[(0,s.jsx)("div",{className:"overflow-x-auto",children:(0,s.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,s.jsx)("thead",{className:"bg-gray-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Patient"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Doctor"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date & Time"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,s.jsx)("th",{className:"px-6 py-4 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee"}),(0,s.jsx)("th",{className:"px-6 py-4 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,s.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:a?(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:7,className:"px-6 py-12 text-center",children:(0,s.jsxs)("div",{className:"flex items-center justify-center",children:[(0,s.jsx)(U.A,{className:"animate-spin h-6 w-6 text-orange-500 mr-3"}),(0,s.jsx)("span",{className:"text-gray-500",children:"Loading appointments..."})]})})}):0===e.length?(0,s.jsx)("tr",{children:(0,s.jsxs)("td",{colSpan:7,className:"px-6 py-12 text-center",children:[(0,s.jsx)(r.A,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),(0,s.jsx)("p",{className:"text-gray-500",children:"No appointments found"}),(0,s.jsxs)("button",{onClick:()=>y(!0),className:"mt-4 inline-flex items-center px-4 py-2 bg-orange-500 text-white rounded-xl hover:bg-orange-600 transition-colors",children:[(0,s.jsx)(c.A,{size:16,className:"mr-2"}),"Book First Appointment"]})]})}):e.map(e=>{var t,a,n,r,i,o;return(0,s.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-orange-100 flex items-center justify-center",children:(0,s.jsx)(u.A,{className:"h-5 w-5 text-orange-600"})})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsxs)("div",{className:"text-sm font-medium text-gray-900",children:[null==(t=e.patient)?void 0:t.first_name," ",null==(a=e.patient)?void 0:a.last_name]}),(0,s.jsxs)("div",{className:"text-sm text-gray-500",children:["ID: ",null==(n=e.patient)?void 0:n.patient_id]}),E(null==e?void 0:e.notes)&&(0,s.jsx)("div",{className:"mt-1",children:(0,s.jsxs)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-emerald-100 text-emerald-700",children:["Token ",E(e.notes)]})})]})]})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"flex-shrink-0 h-10 w-10",children:(0,s.jsx)("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:(0,s.jsx)(g.A,{className:"h-5 w-5 text-blue-600"})})}),(0,s.jsxs)("div",{className:"ml-4",children:[(0,s.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(null==(i=e.doctor)||null==(r=i.user)?void 0:r.name)||"Unknown Doctor"}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:null==(o=e.doctor)?void 0:o.specialization})]})]})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap",children:[(0,s.jsx)("div",{className:"text-sm text-gray-900",children:ee(e.appointment_date)}),(0,s.jsx)("div",{className:"text-sm text-gray-500",children:et(e.appointment_time)})]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 capitalize",children:e.type.replace("_"," ")})}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,s.jsxs)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium border ".concat(K(e.status)),children:[$(e.status),(0,s.jsx)("span",{className:"ml-1 capitalize",children:e.status.replace("_"," ")})]})}),(0,s.jsxs)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[e.duration_minutes," mins"]}),(0,s.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("button",{onClick:()=>X(G===e.id?null:e.id),className:"p-2 text-gray-400 hover:text-gray-600 rounded-lg hover:bg-gray-100",children:(0,s.jsx)(V.A,{size:16})}),G===e.id&&(0,s.jsx)("div",{className:"absolute right-0 mt-2 w-48 bg-white rounded-xl shadow-lg border border-gray-200 z-10",children:(0,s.jsxs)("div",{className:"py-1",children:[(0,s.jsxs)("button",{onClick:()=>Z(e.id,"confirmed"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(x.A,{size:16,className:"mr-3 text-green-500"}),"Confirm"]}),(0,s.jsxs)("button",{onClick:()=>Z(e.id,"completed"),className:"flex items-center w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-50",children:[(0,s.jsx)(x.A,{size:16,className:"mr-3 text-blue-500"}),"Mark Complete"]}),(0,s.jsxs)("button",{onClick:()=>Q(e.id),className:"flex items-center w-full px-4 py-2 text-sm text-red-600 hover:bg-red-50",children:[(0,s.jsx)(R.A,{size:16,className:"mr-3"}),"Cancel"]})]})})]})})]},e.id)})})]})}),ea>1&&(0,s.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[(0,s.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,s.jsx)("button",{onClick:()=>A(Math.max(1,S-1)),disabled:1===S,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,s.jsx)("button",{onClick:()=>A(Math.min(ea,S+1)),disabled:S===ea,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),(0,s.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,s.jsx)("div",{children:(0,s.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,s.jsx)("span",{className:"font-medium",children:(S-1)*C+1})," to"," ",(0,s.jsx)("span",{className:"font-medium",children:Math.min(S*C,T)})," ","of ",(0,s.jsx)("span",{className:"font-medium",children:T})," results"]})}),(0,s.jsx)("div",{children:(0,s.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,s.jsx)("button",{onClick:()=>A(Math.max(1,S-1)),disabled:1===S,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(J.A,{size:20})}),Array.from({length:Math.min(5,ea)},(e,t)=>{let a=Math.max(1,Math.min(ea-4,S-2))+t;return(0,s.jsx)("button",{onClick:()=>A(a),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(S===a?"z-10 bg-orange-50 border-orange-500 text-orange-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:a},a)}),(0,s.jsx)("button",{onClick:()=>A(Math.min(ea,S+1)),disabled:S===ea,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:(0,s.jsx)(W.A,{size:20})})]})})]})]})]})]}),(0,s.jsx)(L,{isOpen:m,onClose:()=>y(!1),onSuccess:()=>{y(!1),H()}})]})},X=()=>{let[e,t]=(0,n.useState)("overview"),[a,m]=(0,n.useState)(!1),p=[{title:"Today's Appointments",value:"24",icon:r.A,color:"bg-blue-500",change:"+12%"},{title:"Pending Confirmations",value:"8",icon:i.A,color:"bg-yellow-500",change:"+5%"},{title:"Active Doctors",value:"15",icon:o.A,color:"bg-green-500",change:"+2%"},{title:"Completed Today",value:"18",icon:l.A,color:"bg-purple-500",change:"+8%"}],x=e=>{let{id:t,label:a,icon:n,isActive:r,onClick:i}=e;return(0,s.jsxs)("button",{onClick:i,className:"flex items-center px-6 py-3 text-sm font-medium rounded-lg transition-all duration-200 ".concat(r?"bg-blue-600 text-white shadow-lg":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"),children:[(0,s.jsx)(n,{className:"w-4 h-4 mr-2"}),a]})};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50",children:[(0,s.jsx)("div",{className:"bg-white/80 backdrop-blur-sm border-b border-gray-200 sticky top-0 z-40",children:(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center py-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Appointment Management"}),(0,s.jsx)("p",{className:"text-gray-600 mt-1",children:"Manage patient appointments and doctor schedules"})]}),(0,s.jsxs)("button",{onClick:()=>m(!0),className:"flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-xl hover:from-blue-700 hover:to-purple-700 transition-all duration-200 shadow-lg hover:shadow-xl transform hover:-translate-y-0.5",children:[(0,s.jsx)(c.A,{className:"w-5 h-5 mr-2"}),"New Appointment"]})]}),(0,s.jsxs)("div",{className:"flex space-x-2 pb-4",children:[(0,s.jsx)(x,{id:"overview",label:"Overview",icon:l.A,isActive:"overview"===e,onClick:()=>t("overview")}),(0,s.jsx)(x,{id:"book",label:"Book Appointment",icon:c.A,isActive:"book"===e,onClick:()=>t("book")}),(0,s.jsx)(x,{id:"manage",label:"Manage Appointments",icon:d.A,isActive:"manage"===e,onClick:()=>t("manage")})]})]})}),(0,s.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:["overview"===e&&(0,s.jsxs)("div",{className:"space-y-8",children:[(0,s.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:p.map((e,t)=>{let a=e.icon;return(0,s.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-gray-200 hover:shadow-lg transition-all duration-200 hover:-translate-y-1",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-600",children:e.title}),(0,s.jsx)("p",{className:"text-3xl font-bold text-gray-900 mt-2",children:e.value}),(0,s.jsxs)("p",{className:"text-sm text-green-600 mt-1",children:[e.change," from yesterday"]})]}),(0,s.jsx)("div",{className:"".concat(e.color," p-3 rounded-xl"),children:(0,s.jsx)(a,{className:"w-6 h-6 text-white"})})]})},t)})}),(0,s.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Actions"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,s.jsxs)("button",{onClick:()=>t("book"),className:"flex items-center p-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-xl hover:from-blue-600 hover:to-blue-700 transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,s.jsx)(c.A,{className:"w-5 h-5 mr-3"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"Book New Appointment"}),(0,s.jsx)("div",{className:"text-sm opacity-90",children:"Schedule patient visit"})]})]}),(0,s.jsxs)("button",{onClick:()=>t("manage"),className:"flex items-center p-4 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl hover:from-green-600 hover:to-green-700 transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,s.jsx)(r.A,{className:"w-5 h-5 mr-3"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"View All Appointments"}),(0,s.jsx)("div",{className:"text-sm opacity-90",children:"Manage existing bookings"})]})]}),(0,s.jsxs)("button",{className:"flex items-center p-4 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all duration-200 shadow-md hover:shadow-lg",children:[(0,s.jsx)(o.A,{className:"w-5 h-5 mr-3"}),(0,s.jsxs)("div",{className:"text-left",children:[(0,s.jsx)("div",{className:"font-medium",children:"Doctor Schedules"}),(0,s.jsx)("div",{className:"text-sm opacity-90",children:"Manage availability"})]})]})]})]}),(0,s.jsxs)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-gray-200",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Recent Activity"}),(0,s.jsx)("div",{className:"space-y-3",children:[{action:"New appointment booked",patient:"John Doe",time:"2 minutes ago",status:"success"},{action:"Appointment confirmed",patient:"Jane Smith",time:"15 minutes ago",status:"info"},{action:"Appointment completed",patient:"Mike Johnson",time:"1 hour ago",status:"success"},{action:"Appointment cancelled",patient:"Sarah Wilson",time:"2 hours ago",status:"warning"}].map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full mr-3 ".concat("success"===e.status?"bg-green-500":"info"===e.status?"bg-blue-500":"warning"===e.status?"bg-yellow-500":"bg-gray-500")}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.action}),(0,s.jsxs)("p",{className:"text-xs text-gray-600",children:["Patient: ",e.patient]})]})]}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:e.time})]},t))})]})]}),"book"===e&&(0,s.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl p-6 border border-gray-200",children:(0,s.jsx)(L,{isOpen:!0,onClose:()=>t("overview"),onSuccess:()=>t("manage")})}),"manage"===e&&(0,s.jsx)("div",{className:"bg-white/70 backdrop-blur-sm rounded-2xl border border-gray-200 overflow-hidden",children:(0,s.jsx)(G,{})})]}),a&&(0,s.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,s.jsx)("div",{className:"p-6 border-b border-gray-200",children:(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Book New Appointment"}),(0,s.jsx)("button",{onClick:()=>m(!1),className:"text-gray-400 hover:text-gray-600 transition-colors",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,s.jsx)("div",{className:"p-6",children:(0,s.jsx)(L,{isOpen:a,onClose:()=>m(!1),onSuccess:()=>{m(!1),t("manage")}})})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[1378,636,6593,8792],()=>t(7366)),_N_E=e.O()}]);